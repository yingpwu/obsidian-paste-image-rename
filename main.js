/* THIS IS A GENERATED/BUNDLED FILE BY ESBUILD */
var __defProp = Object.defineProperty;
var __defProps = Object.defineProperties;
var __getOwnPropDesc = Object.getOwnPropertyDescriptor;
var __getOwnPropDescs = Object.getOwnPropertyDescriptors;
var __getOwnPropNames = Object.getOwnPropertyNames;
var __getOwnPropSymbols = Object.getOwnPropertySymbols;
var __hasOwnProp = Object.prototype.hasOwnProperty;
var __propIsEnum = Object.prototype.propertyIsEnumerable;
var __defNormalProp = (obj, key, value) => key in obj ? __defProp(obj, key, { enumerable: true, configurable: true, writable: true, value }) : obj[key] = value;
var __spreadValues = (a, b) => {
  for (var prop in b || (b = {}))
    if (__hasOwnProp.call(b, prop))
      __defNormalProp(a, prop, b[prop]);
  if (__getOwnPropSymbols)
    for (var prop of __getOwnPropSymbols(b)) {
      if (__propIsEnum.call(b, prop))
        __defNormalProp(a, prop, b[prop]);
    }
  return a;
};
var __spreadProps = (a, b) => __defProps(a, __getOwnPropDescs(b));
var __commonJS = (cb, mod) => function __require() {
  return mod || (0, cb[__getOwnPropNames(cb)[0]])((mod = { exports: {} }).exports, mod), mod.exports;
};
var __export = (target, all) => {
  for (var name in all)
    __defProp(target, name, { get: all[name], enumerable: true });
};
var __copyProps = (to, from, except, desc) => {
  if (from && typeof from === "object" || typeof from === "function") {
    for (let key of __getOwnPropNames(from))
      if (!__hasOwnProp.call(to, key) && key !== except)
        __defProp(to, key, { get: () => from[key], enumerable: !(desc = __getOwnPropDesc(from, key)) || desc.enumerable });
  }
  return to;
};
var __toCommonJS = (mod) => __copyProps(__defProp({}, "__esModule", { value: true }), mod);
var __async = (__this, __arguments, generator) => {
  return new Promise((resolve, reject) => {
    var fulfilled = (value) => {
      try {
        step(generator.next(value));
      } catch (e) {
        reject(e);
      }
    };
    var rejected = (value) => {
      try {
        step(generator.throw(value));
      } catch (e) {
        reject(e);
      }
    };
    var step = (x) => x.done ? resolve(x.value) : Promise.resolve(x.value).then(fulfilled, rejected);
    step((generator = generator.apply(__this, __arguments)).next());
  });
};

// package.json
var require_package = __commonJS({
  "package.json"(exports, module2) {
    module2.exports = {
      name: "obsidian-paste-image-rename",
      version: "1.6.1",
      main: "main.js",
      scripts: {
        dev: "node esbuild.config.mjs",
        build: "tsc -noEmit -skipLibCheck && node esbuild.config.mjs production",
        version: "node version-bump.mjs && git add manifest.json versions.json",
        release: "npm run build && gh release create ${npm_package_version} build/*"
      },
      keywords: [],
      author: "Reorx",
      license: "MIT",
      devDependencies: {
        "@types/node": "^18.11.18",
        "@typescript-eslint/eslint-plugin": "^5.49.0",
        "@typescript-eslint/parser": "^5.49.0",
        "builtin-modules": "^3.3.0",
        esbuild: "0.16.17",
        obsidian: "^1.1.1",
        tslib: "2.5.0",
        typescript: "4.9.4"
      },
      dependencies: {
        "cash-dom": "^8.1.2"
      }
    };
  }
});

// src/main.ts
var main_exports = {};
__export(main_exports, {
  default: () => PasteImageRenamePlugin
});
module.exports = __toCommonJS(main_exports);
var import_obsidian2 = require("obsidian");

// src/batch.ts
var import_obsidian = require("obsidian");

// src/utils.ts
var DEBUG = true;
if (DEBUG)
  console.log("DEBUG is enabled");
function debugLog(...args) {
  if (DEBUG) {
    console.log(new Date().toISOString().slice(11, 23), ...args);
  }
}
function createElementTree(rootEl, opts) {
  const result = {
    el: rootEl.createEl(opts.tag, opts),
    children: []
  };
  const children = opts.children || [];
  for (const child of children) {
    result.children.push(createElementTree(result.el, child));
  }
  return result;
}
var path = {
  // Credit: @creationix/path.js
  join(...partSegments) {
    let parts = [];
    for (let i = 0, l = partSegments.length; i < l; i++) {
      parts = parts.concat(partSegments[i].split("/"));
    }
    const newParts = [];
    for (let i = 0, l = parts.length; i < l; i++) {
      const part = parts[i];
      if (!part || part === ".")
        continue;
      else
        newParts.push(part);
    }
    if (parts[0] === "")
      newParts.unshift("");
    return newParts.join("/");
  },
  // returns the last part of a path, e.g. 'foo.jpg'
  basename(fullpath) {
    const sp = fullpath.split("/");
    return sp[sp.length - 1];
  },
  // return extension without dot, e.g. 'jpg'
  extension(fullpath) {
    const positions = [...fullpath.matchAll(new RegExp("\\.", "gi"))].map((a) => a.index);
    return fullpath.slice(positions[positions.length - 1] + 1);
  }
};
var filenameNotAllowedChars = /[^\p{L}0-9~`!@$&*()\-_=+{};'",<.>? ]/ug;
var sanitizer = {
  filename(s) {
    return s.replace(filenameNotAllowedChars, "").trim();
  },
  delimiter(s) {
    s = this.filename(s);
    if (!s)
      s = "-";
    return s;
  }
};
function escapeRegExp(s) {
  return s.replace(/[.*+?^${}()|[\]\\]/g, "\\$&");
}
function lockInputMethodComposition(el) {
  const state = {
    lock: false
  };
  el.addEventListener("compositionstart", () => {
    state.lock = true;
  });
  el.addEventListener("compositionend", () => {
    state.lock = false;
  });
  return state;
}

// src/batch.ts
var ImageBatchRenameModal = class extends import_obsidian.Modal {
  constructor(app, activeFile, renameFunc, onClose) {
    super(app);
    this.activeFile = activeFile;
    this.renameFunc = renameFunc;
    this.onCloseExtra = onClose;
    this.state = {
      namePattern: "",
      extPattern: "",
      nameReplace: "",
      renameTasks: []
    };
  }
  onOpen() {
    this.containerEl.addClass("image-rename-modal");
    const { contentEl, titleEl } = this;
    titleEl.setText("Batch rename embeded files");
    const namePatternSetting = new import_obsidian.Setting(contentEl).setName("Name pattern").setDesc("Please input the name pattern to match files (regex)").addText((text) => text.setValue(this.state.namePattern).onChange(
      (value) => __async(this, null, function* () {
        this.state.namePattern = value;
      })
    ));
    const npInputEl = namePatternSetting.controlEl.children[0];
    npInputEl.focus();
    const npInputState = lockInputMethodComposition(npInputEl);
    npInputEl.addEventListener("keydown", (e) => __async(this, null, function* () {
      if (e.key === "Enter" && !npInputState.lock) {
        e.preventDefault();
        if (!this.state.namePattern) {
          errorEl.innerText = 'Error: "Name pattern" could not be empty';
          errorEl.style.display = "block";
          return;
        }
        this.matchImageNames(tbodyEl);
      }
    }));
    const extPatternSetting = new import_obsidian.Setting(contentEl).setName("Extension pattern").setDesc("Please input the extension pattern to match files (regex)").addText((text) => text.setValue(this.state.extPattern).onChange(
      (value) => __async(this, null, function* () {
        this.state.extPattern = value;
      })
    ));
    const extInputEl = extPatternSetting.controlEl.children[0];
    extInputEl.addEventListener("keydown", (e) => __async(this, null, function* () {
      if (e.key === "Enter") {
        e.preventDefault();
        this.matchImageNames(tbodyEl);
      }
    }));
    const nameReplaceSetting = new import_obsidian.Setting(contentEl).setName("Name replace").setDesc("Please input the string to replace the matched name (use $1, $2 for regex groups)").addText((text) => text.setValue(this.state.nameReplace).onChange(
      (value) => __async(this, null, function* () {
        this.state.nameReplace = value;
      })
    ));
    const nrInputEl = nameReplaceSetting.controlEl.children[0];
    const nrInputState = lockInputMethodComposition(nrInputEl);
    nrInputEl.addEventListener("keydown", (e) => __async(this, null, function* () {
      if (e.key === "Enter" && !nrInputState.lock) {
        e.preventDefault();
        this.matchImageNames(tbodyEl);
      }
    }));
    const matchedContainer = contentEl.createDiv({
      cls: "matched-container"
    });
    const tableET = createElementTree(matchedContainer, {
      tag: "table",
      children: [
        {
          tag: "thead",
          children: [
            {
              tag: "tr",
              children: [
                {
                  tag: "td",
                  text: "Original path"
                },
                {
                  tag: "td",
                  text: "Renamed Name"
                }
              ]
            }
          ]
        },
        {
          tag: "tbody"
        }
      ]
    });
    const tbodyEl = tableET.children[1].el;
    const errorEl = contentEl.createDiv({
      cls: "error",
      attr: {
        style: "display: none;"
      }
    });
    new import_obsidian.Setting(contentEl).addButton((button) => {
      button.setButtonText("Rename all").setClass("mod-cta").onClick(() => {
        new ConfirmModal(
          this.app,
          "Confirm rename all",
          `Are you sure? This will rename all the ${this.state.renameTasks.length} images matched the pattern.`,
          () => {
            this.renameAll();
            this.close();
          }
        ).open();
      });
    }).addButton((button) => {
      button.setButtonText("Cancel").onClick(() => {
        this.close();
      });
    });
  }
  onClose() {
    const { contentEl } = this;
    contentEl.empty();
    this.onCloseExtra();
  }
  renameAll() {
    return __async(this, null, function* () {
      debugLog("renameAll", this.state);
      for (const task of this.state.renameTasks) {
        yield this.renameFunc(task.file, task.name);
      }
    });
  }
  matchImageNames(tbodyEl) {
    const { state } = this;
    const renameTasks = [];
    tbodyEl.empty();
    const fileCache = this.app.metadataCache.getFileCache(this.activeFile);
    if (!fileCache || !fileCache.embeds)
      return;
    const namePatternRegex = new RegExp(state.namePattern, "g");
    const extPatternRegex = new RegExp(state.extPattern);
    fileCache.embeds.forEach((embed) => {
      const file = this.app.metadataCache.getFirstLinkpathDest(embed.link, this.activeFile.path);
      if (!file) {
        console.warn("file not found", embed.link);
        return;
      }
      if (state.extPattern) {
        const m0 = extPatternRegex.exec(file.extension);
        if (!m0)
          return;
      }
      const stem = file.basename;
      namePatternRegex.lastIndex = 0;
      const m1 = namePatternRegex.exec(stem);
      if (!m1)
        return;
      let renamedName = file.name;
      if (state.nameReplace) {
        namePatternRegex.lastIndex = 0;
        renamedName = stem.replace(namePatternRegex, state.nameReplace);
        renamedName = `${renamedName}.${file.extension}`;
      }
      renameTasks.push({
        file,
        name: renamedName
      });
      createElementTree(tbodyEl, {
        tag: "tr",
        children: [
          {
            tag: "td",
            children: [
              {
                tag: "span",
                text: file.name
              },
              {
                tag: "div",
                text: file.path,
                attr: {
                  class: "file-path"
                }
              }
            ]
          },
          {
            tag: "td",
            children: [
              {
                tag: "span",
                text: renamedName
              },
              {
                tag: "div",
                text: path.join(file.parent.path, renamedName),
                attr: {
                  class: "file-path"
                }
              }
            ]
          }
        ]
      });
    });
    debugLog("new renameTasks", renameTasks);
    state.renameTasks = renameTasks;
  }
};
var ConfirmModal = class extends import_obsidian.Modal {
  constructor(app, title, message, onConfirm) {
    super(app);
    this.title = title;
    this.message = message;
    this.onConfirm = onConfirm;
  }
  onOpen() {
    const { contentEl, titleEl } = this;
    titleEl.setText(this.title);
    contentEl.createEl("p", {
      text: this.message
    });
    new import_obsidian.Setting(contentEl).addButton((button) => {
      button.setButtonText("Yes").setClass("mod-warning").onClick(() => {
        this.onConfirm();
        this.close();
      });
    }).addButton((button) => {
      button.setButtonText("No").onClick(() => {
        this.close();
      });
    });
  }
};

// src/template.ts
var dateTmplRegex = /{{DATE:([^}]+)}}/gm;
var frontmatterTmplRegex = /{{frontmatter:([^}]+)}}/gm;
var replaceDateVar = (s, date) => {
  const m = dateTmplRegex.exec(s);
  if (!m)
    return s;
  return s.replace(m[0], date.format(m[1]));
};
var replaceFrontmatterVar = (s, frontmatter) => {
  if (!frontmatter)
    return s;
  const m = frontmatterTmplRegex.exec(s);
  if (!m)
    return s;
  return s.replace(m[0], frontmatter[m[1]] || "");
};
var renderTemplate = (tmpl, data, frontmatter) => {
  const now = window.moment();
  let text = tmpl;
  let newtext;
  while ((newtext = replaceDateVar(text, now)) != text) {
    text = newtext;
  }
  while ((newtext = replaceFrontmatterVar(text, frontmatter)) != text) {
    text = newtext;
  }
  text = text.replace(/{{imageNameKey}}/gm, data.imageNameKey).replace(/{{fileName}}/gm, data.fileName).replace(/{{dirName}}/gm, data.dirName).replace(/{{firstHeading}}/gm, data.firstHeading);
  return text;
};

// src/main.ts
var DEFAULT_SETTINGS = {
  imageNamePattern: "{{fileName}}",
  dupNumberAtStart: false,
  auto_resize: false,
  dupNumberDelimiter: "-",
  dupNumberAlways: false,
  autoRename: false,
  handleAllAttachments: false,
  excludeExtensionPattern: "",
  disableRenameNotice: false
};
var PASTED_IMAGE_PREFIX = "Pasted image ";
var PasteImageRenamePlugin = class extends import_obsidian2.Plugin {
  constructor() {
    super(...arguments);
    this.modals = [];
  }
  onload() {
    return __async(this, null, function* () {
      const pkg = require_package();
      console.log(
        `Plugin loading: ${pkg.name} ${pkg.version} BUILD_ENV=${""}`
      );
      yield this.loadSettings();
      this.registerEvent(
        this.app.vault.on("create", (file) => {
          if (!(file instanceof import_obsidian2.TFile))
            return;
          const timeGapMs = new Date().getTime() - file.stat.ctime;
          if (timeGapMs > 1e3)
            return;
          if (isMarkdownFile(file))
            return;
          if (isPastedImage(file)) {
            debugLog("pasted image created", file);
            this.startRenameProcess(file, this.settings.autoRename);
          } else {
            if (this.settings.handleAllAttachments) {
              debugLog("handleAllAttachments for file", file);
              if (this.testExcludeExtension(file)) {
                debugLog("excluded file by ext", file);
                return;
              }
              this.startRenameProcess(file, this.settings.autoRename);
            }
          }
        })
      );
      const startBatchRenameProcess = () => {
        this.openBatchRenameModal();
      };
      this.addCommand({
        id: "batch-rename-embeded-files",
        name: "Batch rename embeded files (in the current file)",
        callback: startBatchRenameProcess
      });
      if (DEBUG) {
        this.addRibbonIcon(
          "wand-glyph",
          "Batch rename embeded files",
          startBatchRenameProcess
        );
      }
      const batchRenameAllImages = () => {
        this.batchRenameAllImages();
      };
      this.addCommand({
        id: "batch-rename-all-images",
        name: "Batch rename all images instantly (in the current file)",
        callback: batchRenameAllImages
      });
      if (DEBUG) {
        this.addRibbonIcon(
          "wand-glyph",
          "Batch rename all images instantly (in the current file)",
          batchRenameAllImages
        );
      }
      this.addSettingTab(new SettingTab(this.app, this));
    });
  }
  startRenameProcess(file, autoRename = false) {
    return __async(this, null, function* () {
      const activeFile = this.getActiveFile();
      if (!activeFile) {
        new import_obsidian2.Notice("Error: No active file found.");
        return;
      }
      const { stem, newName, isMeaningful } = this.generateNewName(
        file,
        activeFile
      );
      debugLog("generated newName:", newName, isMeaningful);
      if (!isMeaningful || !autoRename) {
        this.openRenameModal(
          file,
          isMeaningful ? stem : "",
          activeFile.path
        );
        return;
      }
      this.renameFile(file, newName, activeFile.path, true);
    });
  }
  renameFile(file, inputNewName, sourcePath, replaceCurrentLine) {
    return __async(this, null, function* () {
      const { name: newName } = yield this.deduplicateNewName(
        inputNewName,
        file
      );
      debugLog("deduplicated newName:", newName);
      const originName = file.name;
      const linkText = this.app.fileManager.generateMarkdownLink(
        file,
        sourcePath
      );
      const newPath = path.join(file.parent.path, newName);
      try {
        yield this.app.fileManager.renameFile(file, newPath);
      } catch (err) {
        new import_obsidian2.Notice(`Failed to rename ${newName}: ${err}`);
        throw err;
      }
      if (!replaceCurrentLine) {
        return;
      }
      const newLinkText = this.app.fileManager.generateMarkdownLink(
        file,
        sourcePath
      );
      debugLog("replace text", linkText, newLinkText);
      const editor = this.getActiveEditor();
      if (!editor) {
        new import_obsidian2.Notice(`Failed to rename ${newName}: no active editor`);
        return;
      }
      const cursor = editor.getCursor();
      const line = editor.getLine(cursor.line);
      const replacedLine = line.replace(linkText, newLinkText);
      debugLog("current line -> replaced line", line, replacedLine);
      editor.transaction({
        changes: [
          {
            from: __spreadProps(__spreadValues({}, cursor), { ch: 0 }),
            to: __spreadProps(__spreadValues({}, cursor), { ch: line.length }),
            text: replacedLine
          }
        ]
      });
      if (!this.settings.disableRenameNotice) {
        new import_obsidian2.Notice(`Renamed ${originName} to ${newName}`);
      }
    });
  }
  openRenameModal(file, newName, sourcePath) {
    const modal = new ImageRenameModal(
      this.app,
      file,
      newName,
      (confirmedName) => {
        debugLog("confirmedName:", confirmedName);
        this.renameFile(file, confirmedName, sourcePath, true);
      },
      () => {
        this.modals.splice(this.modals.indexOf(modal), 1);
      }
    );
    this.modals.push(modal);
    modal.open();
    debugLog("modals count", this.modals.length);
  }
  openBatchRenameModal() {
    const activeFile = this.getActiveFile();
    const modal = new ImageBatchRenameModal(
      this.app,
      activeFile,
      (file, name) => __async(this, null, function* () {
        yield this.renameFile(file, name, activeFile.path);
      }),
      () => {
        this.modals.splice(this.modals.indexOf(modal), 1);
      }
    );
    this.modals.push(modal);
    modal.open();
  }
  batchRenameAllImages() {
    return __async(this, null, function* () {
      const activeFile = this.getActiveFile();
      const fileCache = this.app.metadataCache.getFileCache(activeFile);
      if (!fileCache || !fileCache.embeds)
        return;
      const extPatternRegex = /jpe?g|png|gif|tiff|webp/i;
      for (const embed of fileCache.embeds) {
        const file = this.app.metadataCache.getFirstLinkpathDest(
          embed.link,
          activeFile.path
        );
        if (!file) {
          console.warn("file not found", embed.link);
          return;
        }
        const m0 = extPatternRegex.exec(file.extension);
        if (!m0)
          return;
        const { newName, isMeaningful } = this.generateNewName(
          file,
          activeFile
        );
        debugLog("generated newName:", newName, isMeaningful);
        if (!isMeaningful) {
          new import_obsidian2.Notice(
            "Failed to batch rename images: the generated name is not meaningful"
          );
          break;
        }
        yield this.renameFile(file, newName, activeFile.path, false);
      }
    });
  }
  // returns a new name for the input file, with extension
  generateNewName(file, activeFile) {
    let imageNameKey = "";
    let firstHeading = "";
    let frontmatter;
    const fileCache = this.app.metadataCache.getFileCache(activeFile);
    if (fileCache) {
      debugLog("frontmatter", fileCache.frontmatter);
      frontmatter = fileCache.frontmatter;
      imageNameKey = (frontmatter == null ? void 0 : frontmatter.imageNameKey) || "";
      firstHeading = getFirstHeading(fileCache.headings);
    } else {
      console.warn(
        "could not get file cache from active file",
        activeFile.name
      );
    }
    const stem = renderTemplate(
      this.settings.imageNamePattern,
      {
        imageNameKey,
        fileName: activeFile.basename,
        dirName: activeFile.parent.name,
        firstHeading
      },
      frontmatter
    );
    const meaninglessRegex = new RegExp(
      `[${this.settings.dupNumberDelimiter}\\s]`,
      "gm"
    );
    return {
      stem,
      newName: stem + "." + file.extension,
      isMeaningful: stem.replace(meaninglessRegex, "") !== ""
    };
  }
  // newName: foo.ext
  deduplicateNewName(newName, file) {
    return __async(this, null, function* () {
      const dir = file.parent.path;
      const listed = yield this.app.vault.adapter.list(dir);
      debugLog("sibling files", listed);
      const newNameExt = path.extension(newName), newNameStem = newName.slice(
        0,
        newName.length - newNameExt.length - 1
      ), newNameStemEscaped = escapeRegExp(newNameStem), delimiter = this.settings.dupNumberDelimiter, delimiterEscaped = escapeRegExp(delimiter);
      let dupNameRegex;
      if (this.settings.dupNumberAtStart) {
        dupNameRegex = new RegExp(
          `^(?<number>\\d+)${delimiterEscaped}(?<name>${newNameStemEscaped})\\.${newNameExt}$`
        );
      } else {
        dupNameRegex = new RegExp(
          `^(?<name>${newNameStemEscaped})${delimiterEscaped}(?<number>\\d+)\\.${newNameExt}$`
        );
      }
      debugLog("dupNameRegex", dupNameRegex);
      const dupNameNumbers = [];
      let isNewNameExist = false;
      for (let sibling of listed.files) {
        sibling = path.basename(sibling);
        if (sibling == newName) {
          isNewNameExist = true;
          continue;
        }
        const m = dupNameRegex.exec(sibling);
        if (!m)
          continue;
        dupNameNumbers.push(parseInt(m.groups.number));
      }
      if (isNewNameExist || this.settings.dupNumberAlways) {
        const newNumber = dupNameNumbers.length > 0 ? Math.max(...dupNameNumbers) + 1 : 1;
        if (this.settings.dupNumberAtStart) {
          newName = `${newNumber}${delimiter}${newNameStem}.${newNameExt}`;
        } else {
          newName = `${newNameStem}${delimiter}${newNumber}.${newNameExt}`;
        }
      }
      return {
        name: newName,
        stem: newName.slice(0, newName.length - newNameExt.length - 1),
        extension: newNameExt
      };
    });
  }
  getActiveFile() {
    const view = this.app.workspace.getActiveViewOfType(import_obsidian2.MarkdownView);
    const file = view == null ? void 0 : view.file;
    debugLog("active file", file == null ? void 0 : file.path);
    return file;
  }
  getActiveEditor() {
    const view = this.app.workspace.getActiveViewOfType(import_obsidian2.MarkdownView);
    return view == null ? void 0 : view.editor;
  }
  onunload() {
    this.modals.map((modal) => modal.close());
  }
  testExcludeExtension(file) {
    const pattern = this.settings.excludeExtensionPattern;
    if (!pattern)
      return false;
    return new RegExp(pattern).test(file.extension);
  }
  loadSettings() {
    return __async(this, null, function* () {
      this.settings = Object.assign(
        {},
        DEFAULT_SETTINGS,
        yield this.loadData()
      );
    });
  }
  saveSettings() {
    return __async(this, null, function* () {
      yield this.saveData(this.settings);
    });
  }
};
function getFirstHeading(headings) {
  if (headings && headings.length > 0) {
    for (const heading of headings) {
      if (heading.level === 1) {
        return heading.heading;
      }
    }
  }
  return "";
}
function isPastedImage(file) {
  if (file instanceof import_obsidian2.TFile) {
    if (file.name.startsWith(PASTED_IMAGE_PREFIX)) {
      return true;
    }
  }
  return false;
}
function isMarkdownFile(file) {
  if (file instanceof import_obsidian2.TFile) {
    if (file.extension === "md") {
      return true;
    }
  }
  return false;
}
var ImageRenameModal = class extends import_obsidian2.Modal {
  constructor(app, src, stem, renameFunc, onClose) {
    super(app);
    this.src = src;
    this.stem = stem;
    this.renameFunc = renameFunc;
    this.onCloseExtra = onClose;
  }
  onOpen() {
    this.containerEl.addClass("image-rename-modal");
    const { contentEl, titleEl } = this;
    titleEl.setText("Rename image");
    const imageContainer = contentEl.createDiv({
      cls: "image-container"
    });
    imageContainer.createEl("img", {
      attr: {
        src: this.app.vault.getResourcePath(this.src)
      }
    });
    let stem = this.stem;
    const ext = this.src.extension;
    const getNewName = (stem2) => stem2 + "." + ext;
    const getNewPath = (stem2) => path.join(this.src.parent.path, getNewName(stem2));
    const infoET = createElementTree(contentEl, {
      tag: "ul",
      cls: "info",
      children: [
        {
          tag: "li",
          children: [
            {
              tag: "span",
              text: "Origin path"
            },
            {
              tag: "span",
              text: this.src.path
            }
          ]
        },
        {
          tag: "li",
          children: [
            {
              tag: "span",
              text: "New path"
            },
            {
              tag: "span",
              text: getNewPath(stem)
            }
          ]
        }
      ]
    });
    const doRename = () => __async(this, null, function* () {
      debugLog("doRename", `stem=${stem}`);
      this.renameFunc(getNewName(stem));
    });
    const nameSetting = new import_obsidian2.Setting(contentEl).setName("New name").setDesc(
      "Please input the new name for the image (without extension)"
    ).addText(
      (text) => text.setValue(stem).onChange((value) => __async(this, null, function* () {
        stem = sanitizer.filename(value);
        infoET.children[1].children[1].el.innerText = getNewPath(stem);
      }))
    );
    const nameInputEl = nameSetting.controlEl.children[0];
    nameInputEl.focus();
    const nameInputState = lockInputMethodComposition(nameInputEl);
    nameInputEl.addEventListener("keydown", (e) => __async(this, null, function* () {
      if (e.key === "Enter" && !nameInputState.lock) {
        e.preventDefault();
        if (!stem) {
          errorEl.innerText = 'Error: "New name" could not be empty';
          errorEl.style.display = "block";
          return;
        }
        doRename();
        this.close();
      }
    }));
    const errorEl = contentEl.createDiv({
      cls: "error",
      attr: {
        style: "display: none;"
      }
    });
    new import_obsidian2.Setting(contentEl).addButton((button) => {
      button.setButtonText("Rename").onClick(() => {
        doRename();
        this.close();
      });
    }).addButton((button) => {
      button.setButtonText("Cancel").onClick(() => {
        this.close();
      });
    });
  }
  onClose() {
    const { contentEl } = this;
    contentEl.empty();
    this.onCloseExtra();
  }
};
var imageNamePatternDesc = `
The pattern indicates how the new name should be generated.

Available variables:
- {{fileName}}: name of the active file, without ".md" extension.
- {{dirName}}: name of the directory which contains the document (the root directory of vault results in an empty variable).
- {{imageNameKey}}: this variable is read from the markdown file's frontmatter, from the same key "imageNameKey".
- {{DATE:$FORMAT}}: use "$FORMAT" to format the current date, "$FORMAT" must be a Moment.js format string, e.g. {{DATE:YYYY-MM-DD}}.

Here are some examples from pattern to image names (repeat in sequence), variables: fileName = "My note", imageNameKey = "foo":
- {{fileName}}: My note, My note-1, My note-2
- {{imageNameKey}}: foo, foo-1, foo-2
- {{imageNameKey}}-{{DATE:YYYYMMDD}}: foo-20220408, foo-20220408-1, foo-20220408-2
`;
var SettingTab = class extends import_obsidian2.PluginSettingTab {
  constructor(app, plugin) {
    super(app, plugin);
    this.plugin = plugin;
  }
  display() {
    const { containerEl } = this;
    containerEl.empty();
    new import_obsidian2.Setting(containerEl).setName("Image name pattern").setDesc(imageNamePatternDesc).setClass("long-description-setting-item").addText(
      (text) => text.setPlaceholder("{{imageNameKey}}").setValue(this.plugin.settings.imageNamePattern).onChange((value) => __async(this, null, function* () {
        this.plugin.settings.imageNamePattern = value;
        yield this.plugin.saveSettings();
      }))
    );
    new import_obsidian2.Setting(containerEl).setName("Duplicate number at start (or end)").setDesc(
      `If enabled, duplicate number will be added at the start as prefix for the image name, otherwise it will be added at the end as suffix for the image name.`
    ).addToggle(
      (toggle) => toggle.setValue(this.plugin.settings.dupNumberAtStart).onChange((value) => __async(this, null, function* () {
        this.plugin.settings.dupNumberAtStart = value;
        yield this.plugin.saveSettings();
      }))
    );
    new import_obsidian2.Setting(containerEl).setName("auto resieze").setDesc(`If enabled, aotu resize the image to a smaller size`).addToggle(
      (toggle) => toggle.setValue(this.plugin.settings.auto_resize).onChange((value) => __async(this, null, function* () {
        this.plugin.settings.auto_resize = value;
        yield this.plugin.saveSettings();
      }))
    );
    new import_obsidian2.Setting(containerEl).setName("Duplicate number delimiter").setDesc(
      `The delimiter to generate the number prefix/suffix for duplicated names. For example, if the value is "-", the suffix will be like "-1", "-2", "-3", and the prefix will be like "1-", "2-", "3-". Only characters that are valid in file names are allowed.`
    ).addText(
      (text) => text.setValue(this.plugin.settings.dupNumberDelimiter).onChange((value) => __async(this, null, function* () {
        this.plugin.settings.dupNumberDelimiter = sanitizer.delimiter(value);
        yield this.plugin.saveSettings();
      }))
    );
    new import_obsidian2.Setting(containerEl).setName("Always add duplicate number").setDesc(
      `If enabled, duplicate number will always be added to the image name. Otherwise, it will only be added when the name is duplicated.`
    ).addToggle(
      (toggle) => toggle.setValue(this.plugin.settings.dupNumberAlways).onChange((value) => __async(this, null, function* () {
        this.plugin.settings.dupNumberAlways = value;
        yield this.plugin.saveSettings();
      }))
    );
    new import_obsidian2.Setting(containerEl).setName("Auto rename").setDesc(
      `By default, the rename modal will always be shown to confirm before renaming, if this option is set, the image will be auto renamed after pasting.`
    ).addToggle(
      (toggle) => toggle.setValue(this.plugin.settings.autoRename).onChange((value) => __async(this, null, function* () {
        this.plugin.settings.autoRename = value;
        yield this.plugin.saveSettings();
      }))
    );
    new import_obsidian2.Setting(containerEl).setName("Handle all attachments").setDesc(
      `By default, the plugin only handles images that starts with "Pasted image " in name,
			which is the prefix Obsidian uses to create images from pasted content.
			If this option is set, the plugin will handle all attachments that are created in the vault.`
    ).addToggle(
      (toggle) => toggle.setValue(this.plugin.settings.handleAllAttachments).onChange((value) => __async(this, null, function* () {
        this.plugin.settings.handleAllAttachments = value;
        yield this.plugin.saveSettings();
      }))
    );
    new import_obsidian2.Setting(containerEl).setName("Exclude extension pattern").setDesc(
      `This option is only useful when "Handle all attachments" is enabled.
			Write a Regex pattern to exclude certain extensions from being handled. Only the first line will be used.`
    ).setClass("single-line-textarea").addTextArea(
      (text) => text.setPlaceholder("docx?|xlsx?|pptx?|zip|rar").setValue(this.plugin.settings.excludeExtensionPattern).onChange((value) => __async(this, null, function* () {
        this.plugin.settings.excludeExtensionPattern = value;
        yield this.plugin.saveSettings();
      }))
    );
    new import_obsidian2.Setting(containerEl).setName("Disable rename notice").setDesc(
      `Turn off this option if you don't want to see the notice when renaming images.
			Note that Obsidian may display a notice when a link has changed, this option cannot disable that.`
    ).addToggle(
      (toggle) => toggle.setValue(this.plugin.settings.disableRenameNotice).onChange((value) => __async(this, null, function* () {
        this.plugin.settings.disableRenameNotice = value;
        yield this.plugin.saveSettings();
      }))
    );
  }
};
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsicGFja2FnZS5qc29uIiwgInNyYy9tYWluLnRzIiwgInNyYy9iYXRjaC50cyIsICJzcmMvdXRpbHMudHMiLCAic3JjL3RlbXBsYXRlLnRzIl0sCiAgInNvdXJjZXNDb250ZW50IjogWyJ7XHJcbiAgICBcIm5hbWVcIjogXCJvYnNpZGlhbi1wYXN0ZS1pbWFnZS1yZW5hbWVcIixcclxuICAgIFwidmVyc2lvblwiOiBcIjEuNi4xXCIsXHJcbiAgICBcIm1haW5cIjogXCJtYWluLmpzXCIsXHJcbiAgICBcInNjcmlwdHNcIjoge1xyXG4gICAgICAgIFwiZGV2XCI6IFwibm9kZSBlc2J1aWxkLmNvbmZpZy5tanNcIixcclxuICAgICAgICBcImJ1aWxkXCI6IFwidHNjIC1ub0VtaXQgLXNraXBMaWJDaGVjayAmJiBub2RlIGVzYnVpbGQuY29uZmlnLm1qcyBwcm9kdWN0aW9uXCIsXHJcbiAgICAgICAgXCJ2ZXJzaW9uXCI6IFwibm9kZSB2ZXJzaW9uLWJ1bXAubWpzICYmIGdpdCBhZGQgbWFuaWZlc3QuanNvbiB2ZXJzaW9ucy5qc29uXCIsXHJcbiAgICAgICAgXCJyZWxlYXNlXCI6IFwibnBtIHJ1biBidWlsZCAmJiBnaCByZWxlYXNlIGNyZWF0ZSAke25wbV9wYWNrYWdlX3ZlcnNpb259IGJ1aWxkLypcIlxyXG4gICAgfSxcclxuICAgIFwia2V5d29yZHNcIjogW10sXHJcbiAgICBcImF1dGhvclwiOiBcIlJlb3J4XCIsXHJcbiAgICBcImxpY2Vuc2VcIjogXCJNSVRcIixcclxuICAgIFwiZGV2RGVwZW5kZW5jaWVzXCI6IHtcclxuICAgICAgICBcIkB0eXBlcy9ub2RlXCI6IFwiXjE4LjExLjE4XCIsXHJcbiAgICAgICAgXCJAdHlwZXNjcmlwdC1lc2xpbnQvZXNsaW50LXBsdWdpblwiOiBcIl41LjQ5LjBcIixcclxuICAgICAgICBcIkB0eXBlc2NyaXB0LWVzbGludC9wYXJzZXJcIjogXCJeNS40OS4wXCIsXHJcbiAgICAgICAgXCJidWlsdGluLW1vZHVsZXNcIjogXCJeMy4zLjBcIixcclxuICAgICAgICBcImVzYnVpbGRcIjogXCIwLjE2LjE3XCIsXHJcbiAgICAgICAgXCJvYnNpZGlhblwiOiBcIl4xLjEuMVwiLFxyXG4gICAgICAgIFwidHNsaWJcIjogXCIyLjUuMFwiLFxyXG4gICAgICAgIFwidHlwZXNjcmlwdFwiOiBcIjQuOS40XCJcclxuICAgIH0sXHJcbiAgICBcImRlcGVuZGVuY2llc1wiOiB7XHJcbiAgICAgICAgXCJjYXNoLWRvbVwiOiBcIl44LjEuMlwiXHJcbiAgICB9XHJcbn1cclxuIiwgIi8qIFRPRE9zOlxyXG4gKiAtIFt4XSBjaGVjayBuYW1lIGV4aXN0ZW5jZSB3aGVuIHNhdmluZ1xyXG4gKiAtIFt4XSBpbWFnZU5hbWVLZXkgaW4gZnJvbnRtYXR0ZXJcclxuICogLSBbeF0gYWZ0ZXIgcmVuYW1pbmcsIGN1cnNvciBzaG91bGQgYmUgcGxhY2VkIGFmdGVyIHRoZSBpbWFnZSBmaWxlIGxpbmtcclxuICogLSBbeF0gaGFuZGxlIGltYWdlIGluc2VydCBmcm9tIGRyYWcnbiBkcm9wXHJcbiAqIC0gWyBdIHNlbGVjdCB0ZXh0IHdoZW4gb3BlbmluZyB0aGUgcmVuYW1pbmcgbW9kYWwsIG1ha2UgdGhpcyBhbiBvcHRpb25cclxuICogLSBbIF0gYWRkIGJ1dHRvbiBmb3IgdXNlIHRoZSBjdXJyZW50IGZpbGUgbmFtZSwgaW1hZ2VOYW1lS2V5LCBsYXN0IGlucHV0IG5hbWUsXHJcbiAqICAgICAgIHNlZ21lbnRzIG9mIGxhc3QgaW5wdXQgbmFtZVxyXG4gKiAtIFt4XSBiYXRjaCByZW5hbWUgYWxsIHBhc3RlZCBpbWFnZXMgaW4gYSBmaWxlXHJcbiAqIC0gWyBdIGFkZCBydWxlcyBmb3IgbW92aW5nIG1hdGNoZWQgaW1hZ2VzIHRvIGRlc3RpbmF0aW9uIGZvbGRlclxyXG4gKi9cclxuaW1wb3J0IHtcclxuXHRBcHAsXHJcblx0SGVhZGluZ0NhY2hlLFxyXG5cdE1hcmtkb3duVmlldyxcclxuXHRNb2RhbCxcclxuXHROb3RpY2UsXHJcblx0UGx1Z2luLFxyXG5cdFBsdWdpblNldHRpbmdUYWIsXHJcblx0U2V0dGluZyxcclxuXHRUQWJzdHJhY3RGaWxlLFxyXG5cdFRGaWxlLFxyXG59IGZyb20gXCJvYnNpZGlhblwiO1xyXG5cclxuaW1wb3J0IHsgSW1hZ2VCYXRjaFJlbmFtZU1vZGFsIH0gZnJvbSBcIi4vYmF0Y2hcIjtcclxuaW1wb3J0IHsgcmVuZGVyVGVtcGxhdGUgfSBmcm9tIFwiLi90ZW1wbGF0ZVwiO1xyXG5pbXBvcnQge1xyXG5cdGNyZWF0ZUVsZW1lbnRUcmVlLFxyXG5cdERFQlVHLFxyXG5cdGRlYnVnTG9nLFxyXG5cdGVzY2FwZVJlZ0V4cCxcclxuXHRsb2NrSW5wdXRNZXRob2RDb21wb3NpdGlvbixcclxuXHROYW1lT2JqLFxyXG5cdHBhdGgsXHJcblx0c2FuaXRpemVyLFxyXG59IGZyb20gXCIuL3V0aWxzXCI7XHJcblxyXG5pbnRlcmZhY2UgUGx1Z2luU2V0dGluZ3Mge1xyXG5cdC8vIHt7aW1hZ2VOYW1lS2V5fX0te3tEQVRFOllZWVlNTUREfX1cclxuXHRpbWFnZU5hbWVQYXR0ZXJuOiBzdHJpbmc7XHJcblx0ZHVwTnVtYmVyQXRTdGFydDogYm9vbGVhbjtcclxuXHRhdXRvX3Jlc2l6ZTogYm9vbGVhbjtcclxuXHRkdXBOdW1iZXJEZWxpbWl0ZXI6IHN0cmluZztcclxuXHRkdXBOdW1iZXJBbHdheXM6IGJvb2xlYW47XHJcblx0YXV0b1JlbmFtZTogYm9vbGVhbjtcclxuXHRoYW5kbGVBbGxBdHRhY2htZW50czogYm9vbGVhbjtcclxuXHRleGNsdWRlRXh0ZW5zaW9uUGF0dGVybjogc3RyaW5nO1xyXG5cdGRpc2FibGVSZW5hbWVOb3RpY2U6IGJvb2xlYW47XHJcbn1cclxuXHJcbmNvbnN0IERFRkFVTFRfU0VUVElOR1M6IFBsdWdpblNldHRpbmdzID0ge1xyXG5cdGltYWdlTmFtZVBhdHRlcm46IFwie3tmaWxlTmFtZX19XCIsXHJcblx0ZHVwTnVtYmVyQXRTdGFydDogZmFsc2UsXHJcblx0YXV0b19yZXNpemU6IGZhbHNlLFxyXG5cdGR1cE51bWJlckRlbGltaXRlcjogXCItXCIsXHJcblx0ZHVwTnVtYmVyQWx3YXlzOiBmYWxzZSxcclxuXHRhdXRvUmVuYW1lOiBmYWxzZSxcclxuXHRoYW5kbGVBbGxBdHRhY2htZW50czogZmFsc2UsXHJcblx0ZXhjbHVkZUV4dGVuc2lvblBhdHRlcm46IFwiXCIsXHJcblx0ZGlzYWJsZVJlbmFtZU5vdGljZTogZmFsc2UsXHJcbn07XHJcblxyXG5jb25zdCBQQVNURURfSU1BR0VfUFJFRklYID0gXCJQYXN0ZWQgaW1hZ2UgXCI7XHJcblxyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBQYXN0ZUltYWdlUmVuYW1lUGx1Z2luIGV4dGVuZHMgUGx1Z2luIHtcclxuXHRzZXR0aW5nczogUGx1Z2luU2V0dGluZ3M7XHJcblx0bW9kYWxzOiBNb2RhbFtdID0gW107XHJcblx0ZXhjbHVkZUV4dGVuc2lvblJlZ2V4OiBSZWdFeHA7XHJcblxyXG5cdGFzeW5jIG9ubG9hZCgpIHtcclxuXHRcdC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tdmFyLXJlcXVpcmVzXHJcblx0XHRjb25zdCBwa2cgPSByZXF1aXJlKFwiLi4vcGFja2FnZS5qc29uXCIpO1xyXG5cdFx0Y29uc29sZS5sb2coXHJcblx0XHRcdGBQbHVnaW4gbG9hZGluZzogJHtwa2cubmFtZX0gJHtwa2cudmVyc2lvbn0gQlVJTERfRU5WPSR7cHJvY2Vzcy5lbnYuQlVJTERfRU5WfWBcclxuXHRcdCk7XHJcblx0XHRhd2FpdCB0aGlzLmxvYWRTZXR0aW5ncygpO1xyXG5cclxuXHRcdHRoaXMucmVnaXN0ZXJFdmVudChcclxuXHRcdFx0dGhpcy5hcHAudmF1bHQub24oXCJjcmVhdGVcIiwgKGZpbGUpID0+IHtcclxuXHRcdFx0XHQvLyBkZWJ1Z0xvZygnZmlsZSBjcmVhdGVkJywgZmlsZSlcclxuXHRcdFx0XHRpZiAoIShmaWxlIGluc3RhbmNlb2YgVEZpbGUpKSByZXR1cm47XHJcblx0XHRcdFx0Y29uc3QgdGltZUdhcE1zID0gbmV3IERhdGUoKS5nZXRUaW1lKCkgLSBmaWxlLnN0YXQuY3RpbWU7XHJcblx0XHRcdFx0Ly8gaWYgdGhlIGZpbGUgaXMgY3JlYXRlZCBtb3JlIHRoYW4gMSBzZWNvbmQgYWdvLCB0aGUgZXZlbnQgaXMgbW9zdCBsaWtlbHkgYmUgZmlyZWQgb24gdmF1bHQgaW5pdGlhbGl6YXRpb24gd2hlbiBzdGFydGluZyBPYnNpZGlhbiBhcHAsIGlnbm9yZSBpdFxyXG5cdFx0XHRcdGlmICh0aW1lR2FwTXMgPiAxMDAwKSByZXR1cm47XHJcblx0XHRcdFx0Ly8gYWx3YXlzIGlnbm9yZSBtYXJrZG93biBmaWxlIGNyZWF0aW9uXHJcblx0XHRcdFx0aWYgKGlzTWFya2Rvd25GaWxlKGZpbGUpKSByZXR1cm47XHJcblx0XHRcdFx0aWYgKGlzUGFzdGVkSW1hZ2UoZmlsZSkpIHtcclxuXHRcdFx0XHRcdGRlYnVnTG9nKFwicGFzdGVkIGltYWdlIGNyZWF0ZWRcIiwgZmlsZSk7XHJcblx0XHRcdFx0XHR0aGlzLnN0YXJ0UmVuYW1lUHJvY2VzcyhmaWxlLCB0aGlzLnNldHRpbmdzLmF1dG9SZW5hbWUpO1xyXG5cdFx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0XHRpZiAodGhpcy5zZXR0aW5ncy5oYW5kbGVBbGxBdHRhY2htZW50cykge1xyXG5cdFx0XHRcdFx0XHRkZWJ1Z0xvZyhcImhhbmRsZUFsbEF0dGFjaG1lbnRzIGZvciBmaWxlXCIsIGZpbGUpO1xyXG5cdFx0XHRcdFx0XHRpZiAodGhpcy50ZXN0RXhjbHVkZUV4dGVuc2lvbihmaWxlKSkge1xyXG5cdFx0XHRcdFx0XHRcdGRlYnVnTG9nKFwiZXhjbHVkZWQgZmlsZSBieSBleHRcIiwgZmlsZSk7XHJcblx0XHRcdFx0XHRcdFx0cmV0dXJuO1xyXG5cdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdHRoaXMuc3RhcnRSZW5hbWVQcm9jZXNzKGZpbGUsIHRoaXMuc2V0dGluZ3MuYXV0b1JlbmFtZSk7XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9KVxyXG5cdFx0KTtcclxuXHJcblx0XHRjb25zdCBzdGFydEJhdGNoUmVuYW1lUHJvY2VzcyA9ICgpID0+IHtcclxuXHRcdFx0dGhpcy5vcGVuQmF0Y2hSZW5hbWVNb2RhbCgpO1xyXG5cdFx0fTtcclxuXHRcdHRoaXMuYWRkQ29tbWFuZCh7XHJcblx0XHRcdGlkOiBcImJhdGNoLXJlbmFtZS1lbWJlZGVkLWZpbGVzXCIsXHJcblx0XHRcdG5hbWU6IFwiQmF0Y2ggcmVuYW1lIGVtYmVkZWQgZmlsZXMgKGluIHRoZSBjdXJyZW50IGZpbGUpXCIsXHJcblx0XHRcdGNhbGxiYWNrOiBzdGFydEJhdGNoUmVuYW1lUHJvY2VzcyxcclxuXHRcdH0pO1xyXG5cdFx0aWYgKERFQlVHKSB7XHJcblx0XHRcdHRoaXMuYWRkUmliYm9uSWNvbihcclxuXHRcdFx0XHRcIndhbmQtZ2x5cGhcIixcclxuXHRcdFx0XHRcIkJhdGNoIHJlbmFtZSBlbWJlZGVkIGZpbGVzXCIsXHJcblx0XHRcdFx0c3RhcnRCYXRjaFJlbmFtZVByb2Nlc3NcclxuXHRcdFx0KTtcclxuXHRcdH1cclxuXHJcblx0XHRjb25zdCBiYXRjaFJlbmFtZUFsbEltYWdlcyA9ICgpID0+IHtcclxuXHRcdFx0dGhpcy5iYXRjaFJlbmFtZUFsbEltYWdlcygpO1xyXG5cdFx0fTtcclxuXHRcdHRoaXMuYWRkQ29tbWFuZCh7XHJcblx0XHRcdGlkOiBcImJhdGNoLXJlbmFtZS1hbGwtaW1hZ2VzXCIsXHJcblx0XHRcdG5hbWU6IFwiQmF0Y2ggcmVuYW1lIGFsbCBpbWFnZXMgaW5zdGFudGx5IChpbiB0aGUgY3VycmVudCBmaWxlKVwiLFxyXG5cdFx0XHRjYWxsYmFjazogYmF0Y2hSZW5hbWVBbGxJbWFnZXMsXHJcblx0XHR9KTtcclxuXHRcdGlmIChERUJVRykge1xyXG5cdFx0XHR0aGlzLmFkZFJpYmJvbkljb24oXHJcblx0XHRcdFx0XCJ3YW5kLWdseXBoXCIsXHJcblx0XHRcdFx0XCJCYXRjaCByZW5hbWUgYWxsIGltYWdlcyBpbnN0YW50bHkgKGluIHRoZSBjdXJyZW50IGZpbGUpXCIsXHJcblx0XHRcdFx0YmF0Y2hSZW5hbWVBbGxJbWFnZXNcclxuXHRcdFx0KTtcclxuXHRcdH1cclxuXHJcblx0XHQvLyBhZGQgc2V0dGluZ3MgdGFiXHJcblx0XHR0aGlzLmFkZFNldHRpbmdUYWIobmV3IFNldHRpbmdUYWIodGhpcy5hcHAsIHRoaXMpKTtcclxuXHR9XHJcblxyXG5cdGFzeW5jIHN0YXJ0UmVuYW1lUHJvY2VzcyhmaWxlOiBURmlsZSwgYXV0b1JlbmFtZSA9IGZhbHNlKSB7XHJcblx0XHQvLyBnZXQgYWN0aXZlIGZpbGUgZmlyc3RcclxuXHRcdGNvbnN0IGFjdGl2ZUZpbGUgPSB0aGlzLmdldEFjdGl2ZUZpbGUoKTtcclxuXHRcdGlmICghYWN0aXZlRmlsZSkge1xyXG5cdFx0XHRuZXcgTm90aWNlKFwiRXJyb3I6IE5vIGFjdGl2ZSBmaWxlIGZvdW5kLlwiKTtcclxuXHRcdFx0cmV0dXJuO1xyXG5cdFx0fVxyXG5cclxuXHRcdGNvbnN0IHsgc3RlbSwgbmV3TmFtZSwgaXNNZWFuaW5nZnVsIH0gPSB0aGlzLmdlbmVyYXRlTmV3TmFtZShcclxuXHRcdFx0ZmlsZSxcclxuXHRcdFx0YWN0aXZlRmlsZVxyXG5cdFx0KTtcclxuXHRcdGRlYnVnTG9nKFwiZ2VuZXJhdGVkIG5ld05hbWU6XCIsIG5ld05hbWUsIGlzTWVhbmluZ2Z1bCk7XHJcblxyXG5cdFx0aWYgKCFpc01lYW5pbmdmdWwgfHwgIWF1dG9SZW5hbWUpIHtcclxuXHRcdFx0dGhpcy5vcGVuUmVuYW1lTW9kYWwoXHJcblx0XHRcdFx0ZmlsZSxcclxuXHRcdFx0XHRpc01lYW5pbmdmdWwgPyBzdGVtIDogXCJcIixcclxuXHRcdFx0XHRhY3RpdmVGaWxlLnBhdGhcclxuXHRcdFx0KTtcclxuXHRcdFx0cmV0dXJuO1xyXG5cdFx0fVxyXG5cdFx0dGhpcy5yZW5hbWVGaWxlKGZpbGUsIG5ld05hbWUsIGFjdGl2ZUZpbGUucGF0aCwgdHJ1ZSk7XHJcblx0fVxyXG5cclxuXHRhc3luYyByZW5hbWVGaWxlKFxyXG5cdFx0ZmlsZTogVEZpbGUsXHJcblx0XHRpbnB1dE5ld05hbWU6IHN0cmluZyxcclxuXHRcdHNvdXJjZVBhdGg6IHN0cmluZyxcclxuXHRcdHJlcGxhY2VDdXJyZW50TGluZT86IGJvb2xlYW5cclxuXHQpIHtcclxuXHRcdC8vIGRlZHVwbGljYXRlIG5hbWVcclxuXHRcdGNvbnN0IHsgbmFtZTogbmV3TmFtZSB9ID0gYXdhaXQgdGhpcy5kZWR1cGxpY2F0ZU5ld05hbWUoXHJcblx0XHRcdGlucHV0TmV3TmFtZSxcclxuXHRcdFx0ZmlsZVxyXG5cdFx0KTtcclxuXHRcdGRlYnVnTG9nKFwiZGVkdXBsaWNhdGVkIG5ld05hbWU6XCIsIG5ld05hbWUpO1xyXG5cdFx0Y29uc3Qgb3JpZ2luTmFtZSA9IGZpbGUubmFtZTtcclxuXHJcblx0XHQvLyBnZW5lcmF0ZSBsaW5rVGV4dCB1c2luZyBPYnNpZGlhbiBBUEksIGxpbmtUZXh0IGlzIGVpdGhlciAgIVtdKGZpbGVuYW1lLnBuZykgb3IgIVtbZmlsZW5hbWUucG5nXV0gYWNjb3JkaW5nIHRvIHRoZSBcIlVzZSBbW1dpa2lsaW5rc11dXCIgc2V0dGluZy5cclxuXHRcdGNvbnN0IGxpbmtUZXh0ID0gdGhpcy5hcHAuZmlsZU1hbmFnZXIuZ2VuZXJhdGVNYXJrZG93bkxpbmsoXHJcblx0XHRcdGZpbGUsXHJcblx0XHRcdHNvdXJjZVBhdGhcclxuXHRcdCk7XHJcblxyXG5cdFx0Ly8gZmlsZSBzeXN0ZW0gb3BlcmF0aW9uOiByZW5hbWUgdGhlIGZpbGVcclxuXHRcdGNvbnN0IG5ld1BhdGggPSBwYXRoLmpvaW4oZmlsZS5wYXJlbnQucGF0aCwgbmV3TmFtZSk7XHJcblx0XHR0cnkge1xyXG5cdFx0XHRhd2FpdCB0aGlzLmFwcC5maWxlTWFuYWdlci5yZW5hbWVGaWxlKGZpbGUsIG5ld1BhdGgpO1xyXG5cdFx0fSBjYXRjaCAoZXJyKSB7XHJcblx0XHRcdG5ldyBOb3RpY2UoYEZhaWxlZCB0byByZW5hbWUgJHtuZXdOYW1lfTogJHtlcnJ9YCk7XHJcblx0XHRcdHRocm93IGVycjtcclxuXHRcdH1cclxuXHJcblx0XHRpZiAoIXJlcGxhY2VDdXJyZW50TGluZSkge1xyXG5cdFx0XHRyZXR1cm47XHJcblx0XHR9XHJcblxyXG5cdFx0Ly8gaW4gY2FzZSBmaWxlTWFuYWdlci5yZW5hbWVGaWxlIG1heSBub3QgdXBkYXRlIHRoZSBpbnRlcm5hbCBsaW5rIGluIHRoZSBhY3RpdmUgZmlsZSxcclxuXHRcdC8vIHdlIG1hbnVhbGx5IHJlcGxhY2UgdGhlIGN1cnJlbnQgbGluZSBieSBtYW5pcHVsYXRpbmcgdGhlIGVkaXRvclxyXG5cclxuXHRcdGNvbnN0IG5ld0xpbmtUZXh0ID0gdGhpcy5hcHAuZmlsZU1hbmFnZXIuZ2VuZXJhdGVNYXJrZG93bkxpbmsoXHJcblx0XHRcdGZpbGUsXHJcblx0XHRcdHNvdXJjZVBhdGhcclxuXHRcdCk7XHJcblx0XHRkZWJ1Z0xvZyhcInJlcGxhY2UgdGV4dFwiLCBsaW5rVGV4dCwgbmV3TGlua1RleHQpO1xyXG5cclxuXHRcdGNvbnN0IGVkaXRvciA9IHRoaXMuZ2V0QWN0aXZlRWRpdG9yKCk7XHJcblx0XHRpZiAoIWVkaXRvcikge1xyXG5cdFx0XHRuZXcgTm90aWNlKGBGYWlsZWQgdG8gcmVuYW1lICR7bmV3TmFtZX06IG5vIGFjdGl2ZSBlZGl0b3JgKTtcclxuXHRcdFx0cmV0dXJuO1xyXG5cdFx0fVxyXG5cclxuXHRcdGNvbnN0IGN1cnNvciA9IGVkaXRvci5nZXRDdXJzb3IoKTtcclxuXHRcdGNvbnN0IGxpbmUgPSBlZGl0b3IuZ2V0TGluZShjdXJzb3IubGluZSk7XHJcblx0XHRjb25zdCByZXBsYWNlZExpbmUgPSBsaW5lLnJlcGxhY2UobGlua1RleHQsIG5ld0xpbmtUZXh0KTtcclxuXHRcdGRlYnVnTG9nKFwiY3VycmVudCBsaW5lIC0+IHJlcGxhY2VkIGxpbmVcIiwgbGluZSwgcmVwbGFjZWRMaW5lKTtcclxuXHRcdC8vIGNvbnNvbGUubG9nKCdlZGl0b3IgY29udGV4dCcsIGN1cnNvciwgKVxyXG5cdFx0ZWRpdG9yLnRyYW5zYWN0aW9uKHtcclxuXHRcdFx0Y2hhbmdlczogW1xyXG5cdFx0XHRcdHtcclxuXHRcdFx0XHRcdGZyb206IHsgLi4uY3Vyc29yLCBjaDogMCB9LFxyXG5cdFx0XHRcdFx0dG86IHsgLi4uY3Vyc29yLCBjaDogbGluZS5sZW5ndGggfSxcclxuXHRcdFx0XHRcdHRleHQ6IHJlcGxhY2VkTGluZSxcclxuXHRcdFx0XHR9LFxyXG5cdFx0XHRdLFxyXG5cdFx0fSk7XHJcblxyXG5cdFx0aWYgKCF0aGlzLnNldHRpbmdzLmRpc2FibGVSZW5hbWVOb3RpY2UpIHtcclxuXHRcdFx0bmV3IE5vdGljZShgUmVuYW1lZCAke29yaWdpbk5hbWV9IHRvICR7bmV3TmFtZX1gKTtcclxuXHRcdH1cclxuXHR9XHJcblxyXG5cdG9wZW5SZW5hbWVNb2RhbChmaWxlOiBURmlsZSwgbmV3TmFtZTogc3RyaW5nLCBzb3VyY2VQYXRoOiBzdHJpbmcpIHtcclxuXHRcdGNvbnN0IG1vZGFsID0gbmV3IEltYWdlUmVuYW1lTW9kYWwoXHJcblx0XHRcdHRoaXMuYXBwLFxyXG5cdFx0XHRmaWxlIGFzIFRGaWxlLFxyXG5cdFx0XHRuZXdOYW1lLFxyXG5cdFx0XHQoY29uZmlybWVkTmFtZTogc3RyaW5nKSA9PiB7XHJcblx0XHRcdFx0ZGVidWdMb2coXCJjb25maXJtZWROYW1lOlwiLCBjb25maXJtZWROYW1lKTtcclxuXHRcdFx0XHR0aGlzLnJlbmFtZUZpbGUoZmlsZSwgY29uZmlybWVkTmFtZSwgc291cmNlUGF0aCwgdHJ1ZSk7XHJcblx0XHRcdH0sXHJcblx0XHRcdCgpID0+IHtcclxuXHRcdFx0XHR0aGlzLm1vZGFscy5zcGxpY2UodGhpcy5tb2RhbHMuaW5kZXhPZihtb2RhbCksIDEpO1xyXG5cdFx0XHR9XHJcblx0XHQpO1xyXG5cdFx0dGhpcy5tb2RhbHMucHVzaChtb2RhbCk7XHJcblx0XHRtb2RhbC5vcGVuKCk7XHJcblx0XHRkZWJ1Z0xvZyhcIm1vZGFscyBjb3VudFwiLCB0aGlzLm1vZGFscy5sZW5ndGgpO1xyXG5cdH1cclxuXHJcblx0b3BlbkJhdGNoUmVuYW1lTW9kYWwoKSB7XHJcblx0XHRjb25zdCBhY3RpdmVGaWxlID0gdGhpcy5nZXRBY3RpdmVGaWxlKCk7XHJcblx0XHRjb25zdCBtb2RhbCA9IG5ldyBJbWFnZUJhdGNoUmVuYW1lTW9kYWwoXHJcblx0XHRcdHRoaXMuYXBwLFxyXG5cdFx0XHRhY3RpdmVGaWxlLFxyXG5cdFx0XHRhc3luYyAoZmlsZTogVEZpbGUsIG5hbWU6IHN0cmluZykgPT4ge1xyXG5cdFx0XHRcdGF3YWl0IHRoaXMucmVuYW1lRmlsZShmaWxlLCBuYW1lLCBhY3RpdmVGaWxlLnBhdGgpO1xyXG5cdFx0XHR9LFxyXG5cdFx0XHQoKSA9PiB7XHJcblx0XHRcdFx0dGhpcy5tb2RhbHMuc3BsaWNlKHRoaXMubW9kYWxzLmluZGV4T2YobW9kYWwpLCAxKTtcclxuXHRcdFx0fVxyXG5cdFx0KTtcclxuXHRcdHRoaXMubW9kYWxzLnB1c2gobW9kYWwpO1xyXG5cdFx0bW9kYWwub3BlbigpO1xyXG5cdH1cclxuXHJcblx0YXN5bmMgYmF0Y2hSZW5hbWVBbGxJbWFnZXMoKSB7XHJcblx0XHRjb25zdCBhY3RpdmVGaWxlID0gdGhpcy5nZXRBY3RpdmVGaWxlKCk7XHJcblx0XHRjb25zdCBmaWxlQ2FjaGUgPSB0aGlzLmFwcC5tZXRhZGF0YUNhY2hlLmdldEZpbGVDYWNoZShhY3RpdmVGaWxlKTtcclxuXHRcdGlmICghZmlsZUNhY2hlIHx8ICFmaWxlQ2FjaGUuZW1iZWRzKSByZXR1cm47XHJcblx0XHRjb25zdCBleHRQYXR0ZXJuUmVnZXggPSAvanBlP2d8cG5nfGdpZnx0aWZmfHdlYnAvaTtcclxuXHJcblx0XHRmb3IgKGNvbnN0IGVtYmVkIG9mIGZpbGVDYWNoZS5lbWJlZHMpIHtcclxuXHRcdFx0Y29uc3QgZmlsZSA9IHRoaXMuYXBwLm1ldGFkYXRhQ2FjaGUuZ2V0Rmlyc3RMaW5rcGF0aERlc3QoXHJcblx0XHRcdFx0ZW1iZWQubGluayxcclxuXHRcdFx0XHRhY3RpdmVGaWxlLnBhdGhcclxuXHRcdFx0KTtcclxuXHRcdFx0aWYgKCFmaWxlKSB7XHJcblx0XHRcdFx0Y29uc29sZS53YXJuKFwiZmlsZSBub3QgZm91bmRcIiwgZW1iZWQubGluayk7XHJcblx0XHRcdFx0cmV0dXJuO1xyXG5cdFx0XHR9XHJcblx0XHRcdC8vIG1hdGNoIGV4dFxyXG5cdFx0XHRjb25zdCBtMCA9IGV4dFBhdHRlcm5SZWdleC5leGVjKGZpbGUuZXh0ZW5zaW9uKTtcclxuXHRcdFx0aWYgKCFtMCkgcmV0dXJuO1xyXG5cclxuXHRcdFx0Ly8gcmVuYW1lXHJcblx0XHRcdGNvbnN0IHsgbmV3TmFtZSwgaXNNZWFuaW5nZnVsIH0gPSB0aGlzLmdlbmVyYXRlTmV3TmFtZShcclxuXHRcdFx0XHRmaWxlLFxyXG5cdFx0XHRcdGFjdGl2ZUZpbGVcclxuXHRcdFx0KTtcclxuXHRcdFx0ZGVidWdMb2coXCJnZW5lcmF0ZWQgbmV3TmFtZTpcIiwgbmV3TmFtZSwgaXNNZWFuaW5nZnVsKTtcclxuXHRcdFx0aWYgKCFpc01lYW5pbmdmdWwpIHtcclxuXHRcdFx0XHRuZXcgTm90aWNlKFxyXG5cdFx0XHRcdFx0XCJGYWlsZWQgdG8gYmF0Y2ggcmVuYW1lIGltYWdlczogdGhlIGdlbmVyYXRlZCBuYW1lIGlzIG5vdCBtZWFuaW5nZnVsXCJcclxuXHRcdFx0XHQpO1xyXG5cdFx0XHRcdGJyZWFrO1xyXG5cdFx0XHR9XHJcblxyXG5cdFx0XHRhd2FpdCB0aGlzLnJlbmFtZUZpbGUoZmlsZSwgbmV3TmFtZSwgYWN0aXZlRmlsZS5wYXRoLCBmYWxzZSk7XHJcblx0XHR9XHJcblx0fVxyXG5cclxuXHQvLyByZXR1cm5zIGEgbmV3IG5hbWUgZm9yIHRoZSBpbnB1dCBmaWxlLCB3aXRoIGV4dGVuc2lvblxyXG5cdGdlbmVyYXRlTmV3TmFtZShmaWxlOiBURmlsZSwgYWN0aXZlRmlsZTogVEZpbGUpIHtcclxuXHRcdGxldCBpbWFnZU5hbWVLZXkgPSBcIlwiO1xyXG5cdFx0bGV0IGZpcnN0SGVhZGluZyA9IFwiXCI7XHJcblx0XHRsZXQgZnJvbnRtYXR0ZXI7XHJcblx0XHRjb25zdCBmaWxlQ2FjaGUgPSB0aGlzLmFwcC5tZXRhZGF0YUNhY2hlLmdldEZpbGVDYWNoZShhY3RpdmVGaWxlKTtcclxuXHRcdGlmIChmaWxlQ2FjaGUpIHtcclxuXHRcdFx0ZGVidWdMb2coXCJmcm9udG1hdHRlclwiLCBmaWxlQ2FjaGUuZnJvbnRtYXR0ZXIpO1xyXG5cdFx0XHRmcm9udG1hdHRlciA9IGZpbGVDYWNoZS5mcm9udG1hdHRlcjtcclxuXHRcdFx0aW1hZ2VOYW1lS2V5ID0gZnJvbnRtYXR0ZXI/LmltYWdlTmFtZUtleSB8fCBcIlwiO1xyXG5cdFx0XHRmaXJzdEhlYWRpbmcgPSBnZXRGaXJzdEhlYWRpbmcoZmlsZUNhY2hlLmhlYWRpbmdzKTtcclxuXHRcdH0gZWxzZSB7XHJcblx0XHRcdGNvbnNvbGUud2FybihcclxuXHRcdFx0XHRcImNvdWxkIG5vdCBnZXQgZmlsZSBjYWNoZSBmcm9tIGFjdGl2ZSBmaWxlXCIsXHJcblx0XHRcdFx0YWN0aXZlRmlsZS5uYW1lXHJcblx0XHRcdCk7XHJcblx0XHR9XHJcblxyXG5cdFx0Y29uc3Qgc3RlbSA9IHJlbmRlclRlbXBsYXRlKFxyXG5cdFx0XHR0aGlzLnNldHRpbmdzLmltYWdlTmFtZVBhdHRlcm4sXHJcblx0XHRcdHtcclxuXHRcdFx0XHRpbWFnZU5hbWVLZXksXHJcblx0XHRcdFx0ZmlsZU5hbWU6IGFjdGl2ZUZpbGUuYmFzZW5hbWUsXHJcblx0XHRcdFx0ZGlyTmFtZTogYWN0aXZlRmlsZS5wYXJlbnQubmFtZSxcclxuXHRcdFx0XHRmaXJzdEhlYWRpbmcsXHJcblx0XHRcdH0sXHJcblx0XHRcdGZyb250bWF0dGVyXHJcblx0XHQpO1xyXG5cdFx0Y29uc3QgbWVhbmluZ2xlc3NSZWdleCA9IG5ldyBSZWdFeHAoXHJcblx0XHRcdGBbJHt0aGlzLnNldHRpbmdzLmR1cE51bWJlckRlbGltaXRlcn1cXFxcc11gLFxyXG5cdFx0XHRcImdtXCJcclxuXHRcdCk7XHJcblxyXG5cdFx0cmV0dXJuIHtcclxuXHRcdFx0c3RlbSxcclxuXHRcdFx0bmV3TmFtZTogc3RlbSArIFwiLlwiICsgZmlsZS5leHRlbnNpb24sXHJcblx0XHRcdGlzTWVhbmluZ2Z1bDogc3RlbS5yZXBsYWNlKG1lYW5pbmdsZXNzUmVnZXgsIFwiXCIpICE9PSBcIlwiLFxyXG5cdFx0fTtcclxuXHR9XHJcblxyXG5cdC8vIG5ld05hbWU6IGZvby5leHRcclxuXHRhc3luYyBkZWR1cGxpY2F0ZU5ld05hbWUobmV3TmFtZTogc3RyaW5nLCBmaWxlOiBURmlsZSk6IFByb21pc2U8TmFtZU9iaj4ge1xyXG5cdFx0Ly8gbGlzdCBmaWxlcyBpbiBkaXJcclxuXHRcdGNvbnN0IGRpciA9IGZpbGUucGFyZW50LnBhdGg7XHJcblx0XHRjb25zdCBsaXN0ZWQgPSBhd2FpdCB0aGlzLmFwcC52YXVsdC5hZGFwdGVyLmxpc3QoZGlyKTtcclxuXHRcdGRlYnVnTG9nKFwic2libGluZyBmaWxlc1wiLCBsaXN0ZWQpO1xyXG5cclxuXHRcdC8vIHBhcnNlIG5ld05hbWVcclxuXHRcdGNvbnN0IG5ld05hbWVFeHQgPSBwYXRoLmV4dGVuc2lvbihuZXdOYW1lKSxcclxuXHRcdFx0bmV3TmFtZVN0ZW0gPSBuZXdOYW1lLnNsaWNlKFxyXG5cdFx0XHRcdDAsXHJcblx0XHRcdFx0bmV3TmFtZS5sZW5ndGggLSBuZXdOYW1lRXh0Lmxlbmd0aCAtIDFcclxuXHRcdFx0KSxcclxuXHRcdFx0bmV3TmFtZVN0ZW1Fc2NhcGVkID0gZXNjYXBlUmVnRXhwKG5ld05hbWVTdGVtKSxcclxuXHRcdFx0ZGVsaW1pdGVyID0gdGhpcy5zZXR0aW5ncy5kdXBOdW1iZXJEZWxpbWl0ZXIsXHJcblx0XHRcdGRlbGltaXRlckVzY2FwZWQgPSBlc2NhcGVSZWdFeHAoZGVsaW1pdGVyKTtcclxuXHJcblx0XHRsZXQgZHVwTmFtZVJlZ2V4O1xyXG5cdFx0aWYgKHRoaXMuc2V0dGluZ3MuZHVwTnVtYmVyQXRTdGFydCkge1xyXG5cdFx0XHRkdXBOYW1lUmVnZXggPSBuZXcgUmVnRXhwKFxyXG5cdFx0XHRcdGBeKD88bnVtYmVyPlxcXFxkKykke2RlbGltaXRlckVzY2FwZWR9KD88bmFtZT4ke25ld05hbWVTdGVtRXNjYXBlZH0pXFxcXC4ke25ld05hbWVFeHR9JGBcclxuXHRcdFx0KTtcclxuXHRcdH0gZWxzZSB7XHJcblx0XHRcdGR1cE5hbWVSZWdleCA9IG5ldyBSZWdFeHAoXHJcblx0XHRcdFx0YF4oPzxuYW1lPiR7bmV3TmFtZVN0ZW1Fc2NhcGVkfSkke2RlbGltaXRlckVzY2FwZWR9KD88bnVtYmVyPlxcXFxkKylcXFxcLiR7bmV3TmFtZUV4dH0kYFxyXG5cdFx0XHQpO1xyXG5cdFx0fVxyXG5cdFx0ZGVidWdMb2coXCJkdXBOYW1lUmVnZXhcIiwgZHVwTmFtZVJlZ2V4KTtcclxuXHJcblx0XHRjb25zdCBkdXBOYW1lTnVtYmVyczogbnVtYmVyW10gPSBbXTtcclxuXHRcdGxldCBpc05ld05hbWVFeGlzdCA9IGZhbHNlO1xyXG5cdFx0Zm9yIChsZXQgc2libGluZyBvZiBsaXN0ZWQuZmlsZXMpIHtcclxuXHRcdFx0c2libGluZyA9IHBhdGguYmFzZW5hbWUoc2libGluZyk7XHJcblx0XHRcdGlmIChzaWJsaW5nID09IG5ld05hbWUpIHtcclxuXHRcdFx0XHRpc05ld05hbWVFeGlzdCA9IHRydWU7XHJcblx0XHRcdFx0Y29udGludWU7XHJcblx0XHRcdH1cclxuXHJcblx0XHRcdC8vIG1hdGNoIGR1cE5hbWVzXHJcblx0XHRcdGNvbnN0IG0gPSBkdXBOYW1lUmVnZXguZXhlYyhzaWJsaW5nKTtcclxuXHRcdFx0aWYgKCFtKSBjb250aW51ZTtcclxuXHRcdFx0Ly8gcGFyc2UgaW50IGZvciBtLmdyb3Vwcy5udW1iZXJcclxuXHRcdFx0ZHVwTmFtZU51bWJlcnMucHVzaChwYXJzZUludChtLmdyb3Vwcy5udW1iZXIpKTtcclxuXHRcdH1cclxuXHJcblx0XHRpZiAoaXNOZXdOYW1lRXhpc3QgfHwgdGhpcy5zZXR0aW5ncy5kdXBOdW1iZXJBbHdheXMpIHtcclxuXHRcdFx0Ly8gZ2V0IG1heCBudW1iZXJcclxuXHRcdFx0Y29uc3QgbmV3TnVtYmVyID1cclxuXHRcdFx0XHRkdXBOYW1lTnVtYmVycy5sZW5ndGggPiAwID8gTWF0aC5tYXgoLi4uZHVwTmFtZU51bWJlcnMpICsgMSA6IDE7XHJcblx0XHRcdC8vIGNoYW5nZSBuZXdOYW1lXHJcblx0XHRcdGlmICh0aGlzLnNldHRpbmdzLmR1cE51bWJlckF0U3RhcnQpIHtcclxuXHRcdFx0XHRuZXdOYW1lID0gYCR7bmV3TnVtYmVyfSR7ZGVsaW1pdGVyfSR7bmV3TmFtZVN0ZW19LiR7bmV3TmFtZUV4dH1gO1xyXG5cdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdG5ld05hbWUgPSBgJHtuZXdOYW1lU3RlbX0ke2RlbGltaXRlcn0ke25ld051bWJlcn0uJHtuZXdOYW1lRXh0fWA7XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHJcblx0XHRyZXR1cm4ge1xyXG5cdFx0XHRuYW1lOiBuZXdOYW1lLFxyXG5cdFx0XHRzdGVtOiBuZXdOYW1lLnNsaWNlKDAsIG5ld05hbWUubGVuZ3RoIC0gbmV3TmFtZUV4dC5sZW5ndGggLSAxKSxcclxuXHRcdFx0ZXh0ZW5zaW9uOiBuZXdOYW1lRXh0LFxyXG5cdFx0fTtcclxuXHR9XHJcblxyXG5cdGdldEFjdGl2ZUZpbGUoKSB7XHJcblx0XHRjb25zdCB2aWV3ID0gdGhpcy5hcHAud29ya3NwYWNlLmdldEFjdGl2ZVZpZXdPZlR5cGUoTWFya2Rvd25WaWV3KTtcclxuXHRcdGNvbnN0IGZpbGUgPSB2aWV3Py5maWxlO1xyXG5cdFx0ZGVidWdMb2coXCJhY3RpdmUgZmlsZVwiLCBmaWxlPy5wYXRoKTtcclxuXHRcdHJldHVybiBmaWxlO1xyXG5cdH1cclxuXHRnZXRBY3RpdmVFZGl0b3IoKSB7XHJcblx0XHRjb25zdCB2aWV3ID0gdGhpcy5hcHAud29ya3NwYWNlLmdldEFjdGl2ZVZpZXdPZlR5cGUoTWFya2Rvd25WaWV3KTtcclxuXHRcdHJldHVybiB2aWV3Py5lZGl0b3I7XHJcblx0fVxyXG5cclxuXHRvbnVubG9hZCgpIHtcclxuXHRcdHRoaXMubW9kYWxzLm1hcCgobW9kYWwpID0+IG1vZGFsLmNsb3NlKCkpO1xyXG5cdH1cclxuXHJcblx0dGVzdEV4Y2x1ZGVFeHRlbnNpb24oZmlsZTogVEZpbGUpOiBib29sZWFuIHtcclxuXHRcdGNvbnN0IHBhdHRlcm4gPSB0aGlzLnNldHRpbmdzLmV4Y2x1ZGVFeHRlbnNpb25QYXR0ZXJuO1xyXG5cdFx0aWYgKCFwYXR0ZXJuKSByZXR1cm4gZmFsc2U7XHJcblx0XHRyZXR1cm4gbmV3IFJlZ0V4cChwYXR0ZXJuKS50ZXN0KGZpbGUuZXh0ZW5zaW9uKTtcclxuXHR9XHJcblxyXG5cdGFzeW5jIGxvYWRTZXR0aW5ncygpIHtcclxuXHRcdHRoaXMuc2V0dGluZ3MgPSBPYmplY3QuYXNzaWduKFxyXG5cdFx0XHR7fSxcclxuXHRcdFx0REVGQVVMVF9TRVRUSU5HUyxcclxuXHRcdFx0YXdhaXQgdGhpcy5sb2FkRGF0YSgpXHJcblx0XHQpO1xyXG5cdH1cclxuXHJcblx0YXN5bmMgc2F2ZVNldHRpbmdzKCkge1xyXG5cdFx0YXdhaXQgdGhpcy5zYXZlRGF0YSh0aGlzLnNldHRpbmdzKTtcclxuXHR9XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGdldEZpcnN0SGVhZGluZyhoZWFkaW5ncz86IEhlYWRpbmdDYWNoZVtdKSB7XHJcblx0aWYgKGhlYWRpbmdzICYmIGhlYWRpbmdzLmxlbmd0aCA+IDApIHtcclxuXHRcdGZvciAoY29uc3QgaGVhZGluZyBvZiBoZWFkaW5ncykge1xyXG5cdFx0XHRpZiAoaGVhZGluZy5sZXZlbCA9PT0gMSkge1xyXG5cdFx0XHRcdHJldHVybiBoZWFkaW5nLmhlYWRpbmc7XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHR9XHJcblx0cmV0dXJuIFwiXCI7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGlzUGFzdGVkSW1hZ2UoZmlsZTogVEFic3RyYWN0RmlsZSk6IGJvb2xlYW4ge1xyXG5cdGlmIChmaWxlIGluc3RhbmNlb2YgVEZpbGUpIHtcclxuXHRcdGlmIChmaWxlLm5hbWUuc3RhcnRzV2l0aChQQVNURURfSU1BR0VfUFJFRklYKSkge1xyXG5cdFx0XHRyZXR1cm4gdHJ1ZTtcclxuXHRcdH1cclxuXHR9XHJcblx0cmV0dXJuIGZhbHNlO1xyXG59XHJcblxyXG5mdW5jdGlvbiBpc01hcmtkb3duRmlsZShmaWxlOiBUQWJzdHJhY3RGaWxlKTogYm9vbGVhbiB7XHJcblx0aWYgKGZpbGUgaW5zdGFuY2VvZiBURmlsZSkge1xyXG5cdFx0aWYgKGZpbGUuZXh0ZW5zaW9uID09PSBcIm1kXCIpIHtcclxuXHRcdFx0cmV0dXJuIHRydWU7XHJcblx0XHR9XHJcblx0fVxyXG5cdHJldHVybiBmYWxzZTtcclxufVxyXG5cclxuY29uc3QgSU1BR0VfRVhUUyA9IFtcImpwZ1wiLCBcImpwZWdcIiwgXCJwbmdcIiwgXCJnaWZcIiwgXCJibXBcIiwgXCJzdmdcIl07XHJcblxyXG5mdW5jdGlvbiBpc0ltYWdlKGZpbGU6IFRBYnN0cmFjdEZpbGUpOiBib29sZWFuIHtcclxuXHRpZiAoZmlsZSBpbnN0YW5jZW9mIFRGaWxlKSB7XHJcblx0XHRpZiAoSU1BR0VfRVhUUy5jb250YWlucyhmaWxlLmV4dGVuc2lvbi50b0xvd2VyQ2FzZSgpKSkge1xyXG5cdFx0XHRyZXR1cm4gdHJ1ZTtcclxuXHRcdH1cclxuXHR9XHJcblx0cmV0dXJuIGZhbHNlO1xyXG59XHJcblxyXG5jbGFzcyBJbWFnZVJlbmFtZU1vZGFsIGV4dGVuZHMgTW9kYWwge1xyXG5cdHNyYzogVEZpbGU7XHJcblx0c3RlbTogc3RyaW5nO1xyXG5cdHJlbmFtZUZ1bmM6IChwYXRoOiBzdHJpbmcpID0+IHZvaWQ7XHJcblx0b25DbG9zZUV4dHJhOiAoKSA9PiB2b2lkO1xyXG5cclxuXHRjb25zdHJ1Y3RvcihcclxuXHRcdGFwcDogQXBwLFxyXG5cdFx0c3JjOiBURmlsZSxcclxuXHRcdHN0ZW06IHN0cmluZyxcclxuXHRcdHJlbmFtZUZ1bmM6IChwYXRoOiBzdHJpbmcpID0+IHZvaWQsXHJcblx0XHRvbkNsb3NlOiAoKSA9PiB2b2lkXHJcblx0KSB7XHJcblx0XHRzdXBlcihhcHApO1xyXG5cdFx0dGhpcy5zcmMgPSBzcmM7XHJcblx0XHR0aGlzLnN0ZW0gPSBzdGVtO1xyXG5cdFx0dGhpcy5yZW5hbWVGdW5jID0gcmVuYW1lRnVuYztcclxuXHRcdHRoaXMub25DbG9zZUV4dHJhID0gb25DbG9zZTtcclxuXHR9XHJcblxyXG5cdG9uT3BlbigpIHtcclxuXHRcdHRoaXMuY29udGFpbmVyRWwuYWRkQ2xhc3MoXCJpbWFnZS1yZW5hbWUtbW9kYWxcIik7XHJcblx0XHRjb25zdCB7IGNvbnRlbnRFbCwgdGl0bGVFbCB9ID0gdGhpcztcclxuXHRcdHRpdGxlRWwuc2V0VGV4dChcIlJlbmFtZSBpbWFnZVwiKTtcclxuXHJcblx0XHRjb25zdCBpbWFnZUNvbnRhaW5lciA9IGNvbnRlbnRFbC5jcmVhdGVEaXYoe1xyXG5cdFx0XHRjbHM6IFwiaW1hZ2UtY29udGFpbmVyXCIsXHJcblx0XHR9KTtcclxuXHRcdGltYWdlQ29udGFpbmVyLmNyZWF0ZUVsKFwiaW1nXCIsIHtcclxuXHRcdFx0YXR0cjoge1xyXG5cdFx0XHRcdHNyYzogdGhpcy5hcHAudmF1bHQuZ2V0UmVzb3VyY2VQYXRoKHRoaXMuc3JjKSxcclxuXHRcdFx0fSxcclxuXHRcdH0pO1xyXG5cclxuXHRcdGxldCBzdGVtID0gdGhpcy5zdGVtO1xyXG5cdFx0Y29uc3QgZXh0ID0gdGhpcy5zcmMuZXh0ZW5zaW9uO1xyXG5cdFx0Y29uc3QgZ2V0TmV3TmFtZSA9IChzdGVtOiBzdHJpbmcpID0+IHN0ZW0gKyBcIi5cIiArIGV4dDtcclxuXHRcdGNvbnN0IGdldE5ld1BhdGggPSAoc3RlbTogc3RyaW5nKSA9PlxyXG5cdFx0XHRwYXRoLmpvaW4odGhpcy5zcmMucGFyZW50LnBhdGgsIGdldE5ld05hbWUoc3RlbSkpO1xyXG5cclxuXHRcdGNvbnN0IGluZm9FVCA9IGNyZWF0ZUVsZW1lbnRUcmVlKGNvbnRlbnRFbCwge1xyXG5cdFx0XHR0YWc6IFwidWxcIixcclxuXHRcdFx0Y2xzOiBcImluZm9cIixcclxuXHRcdFx0Y2hpbGRyZW46IFtcclxuXHRcdFx0XHR7XHJcblx0XHRcdFx0XHR0YWc6IFwibGlcIixcclxuXHRcdFx0XHRcdGNoaWxkcmVuOiBbXHJcblx0XHRcdFx0XHRcdHtcclxuXHRcdFx0XHRcdFx0XHR0YWc6IFwic3BhblwiLFxyXG5cdFx0XHRcdFx0XHRcdHRleHQ6IFwiT3JpZ2luIHBhdGhcIixcclxuXHRcdFx0XHRcdFx0fSxcclxuXHRcdFx0XHRcdFx0e1xyXG5cdFx0XHRcdFx0XHRcdHRhZzogXCJzcGFuXCIsXHJcblx0XHRcdFx0XHRcdFx0dGV4dDogdGhpcy5zcmMucGF0aCxcclxuXHRcdFx0XHRcdFx0fSxcclxuXHRcdFx0XHRcdF0sXHJcblx0XHRcdFx0fSxcclxuXHRcdFx0XHR7XHJcblx0XHRcdFx0XHR0YWc6IFwibGlcIixcclxuXHRcdFx0XHRcdGNoaWxkcmVuOiBbXHJcblx0XHRcdFx0XHRcdHtcclxuXHRcdFx0XHRcdFx0XHR0YWc6IFwic3BhblwiLFxyXG5cdFx0XHRcdFx0XHRcdHRleHQ6IFwiTmV3IHBhdGhcIixcclxuXHRcdFx0XHRcdFx0fSxcclxuXHRcdFx0XHRcdFx0e1xyXG5cdFx0XHRcdFx0XHRcdHRhZzogXCJzcGFuXCIsXHJcblx0XHRcdFx0XHRcdFx0dGV4dDogZ2V0TmV3UGF0aChzdGVtKSxcclxuXHRcdFx0XHRcdFx0fSxcclxuXHRcdFx0XHRcdF0sXHJcblx0XHRcdFx0fSxcclxuXHRcdFx0XSxcclxuXHRcdH0pO1xyXG5cclxuXHRcdGNvbnN0IGRvUmVuYW1lID0gYXN5bmMgKCkgPT4ge1xyXG5cdFx0XHRkZWJ1Z0xvZyhcImRvUmVuYW1lXCIsIGBzdGVtPSR7c3RlbX1gKTtcclxuXHRcdFx0dGhpcy5yZW5hbWVGdW5jKGdldE5ld05hbWUoc3RlbSkpO1xyXG5cdFx0fTtcclxuXHJcblx0XHRjb25zdCBuYW1lU2V0dGluZyA9IG5ldyBTZXR0aW5nKGNvbnRlbnRFbClcclxuXHRcdFx0LnNldE5hbWUoXCJOZXcgbmFtZVwiKVxyXG5cdFx0XHQuc2V0RGVzYyhcclxuXHRcdFx0XHRcIlBsZWFzZSBpbnB1dCB0aGUgbmV3IG5hbWUgZm9yIHRoZSBpbWFnZSAod2l0aG91dCBleHRlbnNpb24pXCJcclxuXHRcdFx0KVxyXG5cdFx0XHQuYWRkVGV4dCgodGV4dCkgPT5cclxuXHRcdFx0XHR0ZXh0LnNldFZhbHVlKHN0ZW0pLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xyXG5cdFx0XHRcdFx0c3RlbSA9IHNhbml0aXplci5maWxlbmFtZSh2YWx1ZSk7XHJcblx0XHRcdFx0XHRpbmZvRVQuY2hpbGRyZW5bMV0uY2hpbGRyZW5bMV0uZWwuaW5uZXJUZXh0ID1cclxuXHRcdFx0XHRcdFx0Z2V0TmV3UGF0aChzdGVtKTtcclxuXHRcdFx0XHR9KVxyXG5cdFx0XHQpO1xyXG5cclxuXHRcdGNvbnN0IG5hbWVJbnB1dEVsID0gbmFtZVNldHRpbmcuY29udHJvbEVsXHJcblx0XHRcdC5jaGlsZHJlblswXSBhcyBIVE1MSW5wdXRFbGVtZW50O1xyXG5cdFx0bmFtZUlucHV0RWwuZm9jdXMoKTtcclxuXHRcdGNvbnN0IG5hbWVJbnB1dFN0YXRlID0gbG9ja0lucHV0TWV0aG9kQ29tcG9zaXRpb24obmFtZUlucHV0RWwpO1xyXG5cdFx0bmFtZUlucHV0RWwuYWRkRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgYXN5bmMgKGUpID0+IHtcclxuXHRcdFx0Ly8gY29uc29sZS5sb2coJ2tleWRvd24nLCBlLmtleSwgYGxvY2s9JHtuYW1lSW5wdXRTdGF0ZS5sb2NrfWApXHJcblx0XHRcdGlmIChlLmtleSA9PT0gXCJFbnRlclwiICYmICFuYW1lSW5wdXRTdGF0ZS5sb2NrKSB7XHJcblx0XHRcdFx0ZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG5cdFx0XHRcdGlmICghc3RlbSkge1xyXG5cdFx0XHRcdFx0ZXJyb3JFbC5pbm5lclRleHQgPSAnRXJyb3I6IFwiTmV3IG5hbWVcIiBjb3VsZCBub3QgYmUgZW1wdHknO1xyXG5cdFx0XHRcdFx0ZXJyb3JFbC5zdHlsZS5kaXNwbGF5ID0gXCJibG9ja1wiO1xyXG5cdFx0XHRcdFx0cmV0dXJuO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHRkb1JlbmFtZSgpO1xyXG5cdFx0XHRcdHRoaXMuY2xvc2UoKTtcclxuXHRcdFx0fVxyXG5cdFx0fSk7XHJcblxyXG5cdFx0Y29uc3QgZXJyb3JFbCA9IGNvbnRlbnRFbC5jcmVhdGVEaXYoe1xyXG5cdFx0XHRjbHM6IFwiZXJyb3JcIixcclxuXHRcdFx0YXR0cjoge1xyXG5cdFx0XHRcdHN0eWxlOiBcImRpc3BsYXk6IG5vbmU7XCIsXHJcblx0XHRcdH0sXHJcblx0XHR9KTtcclxuXHJcblx0XHRuZXcgU2V0dGluZyhjb250ZW50RWwpXHJcblx0XHRcdC5hZGRCdXR0b24oKGJ1dHRvbikgPT4ge1xyXG5cdFx0XHRcdGJ1dHRvbi5zZXRCdXR0b25UZXh0KFwiUmVuYW1lXCIpLm9uQ2xpY2soKCkgPT4ge1xyXG5cdFx0XHRcdFx0ZG9SZW5hbWUoKTtcclxuXHRcdFx0XHRcdHRoaXMuY2xvc2UoKTtcclxuXHRcdFx0XHR9KTtcclxuXHRcdFx0fSlcclxuXHRcdFx0LmFkZEJ1dHRvbigoYnV0dG9uKSA9PiB7XHJcblx0XHRcdFx0YnV0dG9uLnNldEJ1dHRvblRleHQoXCJDYW5jZWxcIikub25DbGljaygoKSA9PiB7XHJcblx0XHRcdFx0XHR0aGlzLmNsb3NlKCk7XHJcblx0XHRcdFx0fSk7XHJcblx0XHRcdH0pO1xyXG5cdH1cclxuXHJcblx0b25DbG9zZSgpIHtcclxuXHRcdGNvbnN0IHsgY29udGVudEVsIH0gPSB0aGlzO1xyXG5cdFx0Y29udGVudEVsLmVtcHR5KCk7XHJcblx0XHR0aGlzLm9uQ2xvc2VFeHRyYSgpO1xyXG5cdH1cclxufVxyXG5cclxuY29uc3QgaW1hZ2VOYW1lUGF0dGVybkRlc2MgPSBgXHJcblRoZSBwYXR0ZXJuIGluZGljYXRlcyBob3cgdGhlIG5ldyBuYW1lIHNob3VsZCBiZSBnZW5lcmF0ZWQuXHJcblxyXG5BdmFpbGFibGUgdmFyaWFibGVzOlxyXG4tIHt7ZmlsZU5hbWV9fTogbmFtZSBvZiB0aGUgYWN0aXZlIGZpbGUsIHdpdGhvdXQgXCIubWRcIiBleHRlbnNpb24uXHJcbi0ge3tkaXJOYW1lfX06IG5hbWUgb2YgdGhlIGRpcmVjdG9yeSB3aGljaCBjb250YWlucyB0aGUgZG9jdW1lbnQgKHRoZSByb290IGRpcmVjdG9yeSBvZiB2YXVsdCByZXN1bHRzIGluIGFuIGVtcHR5IHZhcmlhYmxlKS5cclxuLSB7e2ltYWdlTmFtZUtleX19OiB0aGlzIHZhcmlhYmxlIGlzIHJlYWQgZnJvbSB0aGUgbWFya2Rvd24gZmlsZSdzIGZyb250bWF0dGVyLCBmcm9tIHRoZSBzYW1lIGtleSBcImltYWdlTmFtZUtleVwiLlxyXG4tIHt7REFURTokRk9STUFUfX06IHVzZSBcIiRGT1JNQVRcIiB0byBmb3JtYXQgdGhlIGN1cnJlbnQgZGF0ZSwgXCIkRk9STUFUXCIgbXVzdCBiZSBhIE1vbWVudC5qcyBmb3JtYXQgc3RyaW5nLCBlLmcuIHt7REFURTpZWVlZLU1NLUREfX0uXHJcblxyXG5IZXJlIGFyZSBzb21lIGV4YW1wbGVzIGZyb20gcGF0dGVybiB0byBpbWFnZSBuYW1lcyAocmVwZWF0IGluIHNlcXVlbmNlKSwgdmFyaWFibGVzOiBmaWxlTmFtZSA9IFwiTXkgbm90ZVwiLCBpbWFnZU5hbWVLZXkgPSBcImZvb1wiOlxyXG4tIHt7ZmlsZU5hbWV9fTogTXkgbm90ZSwgTXkgbm90ZS0xLCBNeSBub3RlLTJcclxuLSB7e2ltYWdlTmFtZUtleX19OiBmb28sIGZvby0xLCBmb28tMlxyXG4tIHt7aW1hZ2VOYW1lS2V5fX0te3tEQVRFOllZWVlNTUREfX06IGZvby0yMDIyMDQwOCwgZm9vLTIwMjIwNDA4LTEsIGZvby0yMDIyMDQwOC0yXHJcbmA7XHJcblxyXG5jbGFzcyBTZXR0aW5nVGFiIGV4dGVuZHMgUGx1Z2luU2V0dGluZ1RhYiB7XHJcblx0cGx1Z2luOiBQYXN0ZUltYWdlUmVuYW1lUGx1Z2luO1xyXG5cclxuXHRjb25zdHJ1Y3RvcihhcHA6IEFwcCwgcGx1Z2luOiBQYXN0ZUltYWdlUmVuYW1lUGx1Z2luKSB7XHJcblx0XHRzdXBlcihhcHAsIHBsdWdpbik7XHJcblx0XHR0aGlzLnBsdWdpbiA9IHBsdWdpbjtcclxuXHR9XHJcblxyXG5cdGRpc3BsYXkoKTogdm9pZCB7XHJcblx0XHRjb25zdCB7IGNvbnRhaW5lckVsIH0gPSB0aGlzO1xyXG5cdFx0Y29udGFpbmVyRWwuZW1wdHkoKTtcclxuXHJcblx0XHRuZXcgU2V0dGluZyhjb250YWluZXJFbClcclxuXHRcdFx0LnNldE5hbWUoXCJJbWFnZSBuYW1lIHBhdHRlcm5cIilcclxuXHRcdFx0LnNldERlc2MoaW1hZ2VOYW1lUGF0dGVybkRlc2MpXHJcblx0XHRcdC5zZXRDbGFzcyhcImxvbmctZGVzY3JpcHRpb24tc2V0dGluZy1pdGVtXCIpXHJcblx0XHRcdC5hZGRUZXh0KCh0ZXh0KSA9PlxyXG5cdFx0XHRcdHRleHRcclxuXHRcdFx0XHRcdC5zZXRQbGFjZWhvbGRlcihcInt7aW1hZ2VOYW1lS2V5fX1cIilcclxuXHRcdFx0XHRcdC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5pbWFnZU5hbWVQYXR0ZXJuKVxyXG5cdFx0XHRcdFx0Lm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xyXG5cdFx0XHRcdFx0XHR0aGlzLnBsdWdpbi5zZXR0aW5ncy5pbWFnZU5hbWVQYXR0ZXJuID0gdmFsdWU7XHJcblx0XHRcdFx0XHRcdGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xyXG5cdFx0XHRcdFx0fSlcclxuXHRcdFx0KTtcclxuXHJcblx0XHRuZXcgU2V0dGluZyhjb250YWluZXJFbClcclxuXHRcdFx0LnNldE5hbWUoXCJEdXBsaWNhdGUgbnVtYmVyIGF0IHN0YXJ0IChvciBlbmQpXCIpXHJcblx0XHRcdC5zZXREZXNjKFxyXG5cdFx0XHRcdGBJZiBlbmFibGVkLCBkdXBsaWNhdGUgbnVtYmVyIHdpbGwgYmUgYWRkZWQgYXQgdGhlIHN0YXJ0IGFzIHByZWZpeCBmb3IgdGhlIGltYWdlIG5hbWUsIG90aGVyd2lzZSBpdCB3aWxsIGJlIGFkZGVkIGF0IHRoZSBlbmQgYXMgc3VmZml4IGZvciB0aGUgaW1hZ2UgbmFtZS5gXHJcblx0XHRcdClcclxuXHRcdFx0LmFkZFRvZ2dsZSgodG9nZ2xlKSA9PlxyXG5cdFx0XHRcdHRvZ2dsZVxyXG5cdFx0XHRcdFx0LnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLmR1cE51bWJlckF0U3RhcnQpXHJcblx0XHRcdFx0XHQub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XHJcblx0XHRcdFx0XHRcdHRoaXMucGx1Z2luLnNldHRpbmdzLmR1cE51bWJlckF0U3RhcnQgPSB2YWx1ZTtcclxuXHRcdFx0XHRcdFx0YXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XHJcblx0XHRcdFx0XHR9KVxyXG5cdFx0XHQpO1xyXG5cclxuXHRcdG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxyXG5cdFx0XHQuc2V0TmFtZShcImF1dG8gcmVzaWV6ZVwiKVxyXG5cdFx0XHQuc2V0RGVzYyhgSWYgZW5hYmxlZCwgYW90dSByZXNpemUgdGhlIGltYWdlIHRvIGEgc21hbGxlciBzaXplYClcclxuXHRcdFx0LmFkZFRvZ2dsZSgodG9nZ2xlKSA9PlxyXG5cdFx0XHRcdHRvZ2dsZVxyXG5cdFx0XHRcdFx0LnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLmF1dG9fcmVzaXplKVxyXG5cdFx0XHRcdFx0Lm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xyXG5cdFx0XHRcdFx0XHR0aGlzLnBsdWdpbi5zZXR0aW5ncy5hdXRvX3Jlc2l6ZSA9IHZhbHVlO1xyXG5cdFx0XHRcdFx0XHRhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcclxuXHRcdFx0XHRcdH0pXHJcblx0XHRcdCk7XHJcblxyXG5cdFx0bmV3IFNldHRpbmcoY29udGFpbmVyRWwpXHJcblx0XHRcdC5zZXROYW1lKFwiRHVwbGljYXRlIG51bWJlciBkZWxpbWl0ZXJcIilcclxuXHRcdFx0LnNldERlc2MoXHJcblx0XHRcdFx0YFRoZSBkZWxpbWl0ZXIgdG8gZ2VuZXJhdGUgdGhlIG51bWJlciBwcmVmaXgvc3VmZml4IGZvciBkdXBsaWNhdGVkIG5hbWVzLiBGb3IgZXhhbXBsZSwgaWYgdGhlIHZhbHVlIGlzIFwiLVwiLCB0aGUgc3VmZml4IHdpbGwgYmUgbGlrZSBcIi0xXCIsIFwiLTJcIiwgXCItM1wiLCBhbmQgdGhlIHByZWZpeCB3aWxsIGJlIGxpa2UgXCIxLVwiLCBcIjItXCIsIFwiMy1cIi4gT25seSBjaGFyYWN0ZXJzIHRoYXQgYXJlIHZhbGlkIGluIGZpbGUgbmFtZXMgYXJlIGFsbG93ZWQuYFxyXG5cdFx0XHQpXHJcblx0XHRcdC5hZGRUZXh0KCh0ZXh0KSA9PlxyXG5cdFx0XHRcdHRleHRcclxuXHRcdFx0XHRcdC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5kdXBOdW1iZXJEZWxpbWl0ZXIpXHJcblx0XHRcdFx0XHQub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XHJcblx0XHRcdFx0XHRcdHRoaXMucGx1Z2luLnNldHRpbmdzLmR1cE51bWJlckRlbGltaXRlciA9XHJcblx0XHRcdFx0XHRcdFx0c2FuaXRpemVyLmRlbGltaXRlcih2YWx1ZSk7XHJcblx0XHRcdFx0XHRcdGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xyXG5cdFx0XHRcdFx0fSlcclxuXHRcdFx0KTtcclxuXHJcblx0XHRuZXcgU2V0dGluZyhjb250YWluZXJFbClcclxuXHRcdFx0LnNldE5hbWUoXCJBbHdheXMgYWRkIGR1cGxpY2F0ZSBudW1iZXJcIilcclxuXHRcdFx0LnNldERlc2MoXHJcblx0XHRcdFx0YElmIGVuYWJsZWQsIGR1cGxpY2F0ZSBudW1iZXIgd2lsbCBhbHdheXMgYmUgYWRkZWQgdG8gdGhlIGltYWdlIG5hbWUuIE90aGVyd2lzZSwgaXQgd2lsbCBvbmx5IGJlIGFkZGVkIHdoZW4gdGhlIG5hbWUgaXMgZHVwbGljYXRlZC5gXHJcblx0XHRcdClcclxuXHRcdFx0LmFkZFRvZ2dsZSgodG9nZ2xlKSA9PlxyXG5cdFx0XHRcdHRvZ2dsZVxyXG5cdFx0XHRcdFx0LnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLmR1cE51bWJlckFsd2F5cylcclxuXHRcdFx0XHRcdC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcclxuXHRcdFx0XHRcdFx0dGhpcy5wbHVnaW4uc2V0dGluZ3MuZHVwTnVtYmVyQWx3YXlzID0gdmFsdWU7XHJcblx0XHRcdFx0XHRcdGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xyXG5cdFx0XHRcdFx0fSlcclxuXHRcdFx0KTtcclxuXHJcblx0XHRuZXcgU2V0dGluZyhjb250YWluZXJFbClcclxuXHRcdFx0LnNldE5hbWUoXCJBdXRvIHJlbmFtZVwiKVxyXG5cdFx0XHQuc2V0RGVzYyhcclxuXHRcdFx0XHRgQnkgZGVmYXVsdCwgdGhlIHJlbmFtZSBtb2RhbCB3aWxsIGFsd2F5cyBiZSBzaG93biB0byBjb25maXJtIGJlZm9yZSByZW5hbWluZywgaWYgdGhpcyBvcHRpb24gaXMgc2V0LCB0aGUgaW1hZ2Ugd2lsbCBiZSBhdXRvIHJlbmFtZWQgYWZ0ZXIgcGFzdGluZy5gXHJcblx0XHRcdClcclxuXHRcdFx0LmFkZFRvZ2dsZSgodG9nZ2xlKSA9PlxyXG5cdFx0XHRcdHRvZ2dsZVxyXG5cdFx0XHRcdFx0LnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLmF1dG9SZW5hbWUpXHJcblx0XHRcdFx0XHQub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XHJcblx0XHRcdFx0XHRcdHRoaXMucGx1Z2luLnNldHRpbmdzLmF1dG9SZW5hbWUgPSB2YWx1ZTtcclxuXHRcdFx0XHRcdFx0YXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XHJcblx0XHRcdFx0XHR9KVxyXG5cdFx0XHQpO1xyXG5cclxuXHRcdG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxyXG5cdFx0XHQuc2V0TmFtZShcIkhhbmRsZSBhbGwgYXR0YWNobWVudHNcIilcclxuXHRcdFx0LnNldERlc2MoXHJcblx0XHRcdFx0YEJ5IGRlZmF1bHQsIHRoZSBwbHVnaW4gb25seSBoYW5kbGVzIGltYWdlcyB0aGF0IHN0YXJ0cyB3aXRoIFwiUGFzdGVkIGltYWdlIFwiIGluIG5hbWUsXHJcblx0XHRcdHdoaWNoIGlzIHRoZSBwcmVmaXggT2JzaWRpYW4gdXNlcyB0byBjcmVhdGUgaW1hZ2VzIGZyb20gcGFzdGVkIGNvbnRlbnQuXHJcblx0XHRcdElmIHRoaXMgb3B0aW9uIGlzIHNldCwgdGhlIHBsdWdpbiB3aWxsIGhhbmRsZSBhbGwgYXR0YWNobWVudHMgdGhhdCBhcmUgY3JlYXRlZCBpbiB0aGUgdmF1bHQuYFxyXG5cdFx0XHQpXHJcblx0XHRcdC5hZGRUb2dnbGUoKHRvZ2dsZSkgPT5cclxuXHRcdFx0XHR0b2dnbGVcclxuXHRcdFx0XHRcdC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5oYW5kbGVBbGxBdHRhY2htZW50cylcclxuXHRcdFx0XHRcdC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcclxuXHRcdFx0XHRcdFx0dGhpcy5wbHVnaW4uc2V0dGluZ3MuaGFuZGxlQWxsQXR0YWNobWVudHMgPSB2YWx1ZTtcclxuXHRcdFx0XHRcdFx0YXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XHJcblx0XHRcdFx0XHR9KVxyXG5cdFx0XHQpO1xyXG5cclxuXHRcdG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxyXG5cdFx0XHQuc2V0TmFtZShcIkV4Y2x1ZGUgZXh0ZW5zaW9uIHBhdHRlcm5cIilcclxuXHRcdFx0LnNldERlc2MoXHJcblx0XHRcdFx0YFRoaXMgb3B0aW9uIGlzIG9ubHkgdXNlZnVsIHdoZW4gXCJIYW5kbGUgYWxsIGF0dGFjaG1lbnRzXCIgaXMgZW5hYmxlZC5cclxuXHRcdFx0V3JpdGUgYSBSZWdleCBwYXR0ZXJuIHRvIGV4Y2x1ZGUgY2VydGFpbiBleHRlbnNpb25zIGZyb20gYmVpbmcgaGFuZGxlZC4gT25seSB0aGUgZmlyc3QgbGluZSB3aWxsIGJlIHVzZWQuYFxyXG5cdFx0XHQpXHJcblx0XHRcdC5zZXRDbGFzcyhcInNpbmdsZS1saW5lLXRleHRhcmVhXCIpXHJcblx0XHRcdC5hZGRUZXh0QXJlYSgodGV4dCkgPT5cclxuXHRcdFx0XHR0ZXh0XHJcblx0XHRcdFx0XHQuc2V0UGxhY2Vob2xkZXIoXCJkb2N4P3x4bHN4P3xwcHR4P3x6aXB8cmFyXCIpXHJcblx0XHRcdFx0XHQuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3MuZXhjbHVkZUV4dGVuc2lvblBhdHRlcm4pXHJcblx0XHRcdFx0XHQub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XHJcblx0XHRcdFx0XHRcdHRoaXMucGx1Z2luLnNldHRpbmdzLmV4Y2x1ZGVFeHRlbnNpb25QYXR0ZXJuID0gdmFsdWU7XHJcblx0XHRcdFx0XHRcdGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xyXG5cdFx0XHRcdFx0fSlcclxuXHRcdFx0KTtcclxuXHJcblx0XHRuZXcgU2V0dGluZyhjb250YWluZXJFbClcclxuXHRcdFx0LnNldE5hbWUoXCJEaXNhYmxlIHJlbmFtZSBub3RpY2VcIilcclxuXHRcdFx0LnNldERlc2MoXHJcblx0XHRcdFx0YFR1cm4gb2ZmIHRoaXMgb3B0aW9uIGlmIHlvdSBkb24ndCB3YW50IHRvIHNlZSB0aGUgbm90aWNlIHdoZW4gcmVuYW1pbmcgaW1hZ2VzLlxyXG5cdFx0XHROb3RlIHRoYXQgT2JzaWRpYW4gbWF5IGRpc3BsYXkgYSBub3RpY2Ugd2hlbiBhIGxpbmsgaGFzIGNoYW5nZWQsIHRoaXMgb3B0aW9uIGNhbm5vdCBkaXNhYmxlIHRoYXQuYFxyXG5cdFx0XHQpXHJcblx0XHRcdC5hZGRUb2dnbGUoKHRvZ2dsZSkgPT5cclxuXHRcdFx0XHR0b2dnbGVcclxuXHRcdFx0XHRcdC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5kaXNhYmxlUmVuYW1lTm90aWNlKVxyXG5cdFx0XHRcdFx0Lm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xyXG5cdFx0XHRcdFx0XHR0aGlzLnBsdWdpbi5zZXR0aW5ncy5kaXNhYmxlUmVuYW1lTm90aWNlID0gdmFsdWU7XHJcblx0XHRcdFx0XHRcdGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xyXG5cdFx0XHRcdFx0fSlcclxuXHRcdFx0KTtcclxuXHR9XHJcbn1cclxuIiwgImltcG9ydCB7IE1vZGFsLCBURmlsZSwgQXBwLCBTZXR0aW5nIH0gZnJvbSAnb2JzaWRpYW4nO1xyXG5cclxuaW1wb3J0IHtcclxuICBwYXRoLCBjcmVhdGVFbGVtZW50VHJlZSwgZGVidWdMb2csIGxvY2tJbnB1dE1ldGhvZENvbXBvc2l0aW9uLFxyXG59IGZyb20gJy4vdXRpbHMnO1xyXG5cclxuaW50ZXJmYWNlIFN0YXRlIHtcclxuXHRuYW1lUGF0dGVybjogc3RyaW5nXHJcblx0ZXh0UGF0dGVybjogc3RyaW5nXHJcblx0bmFtZVJlcGxhY2U6IHN0cmluZ1xyXG5cdHJlbmFtZVRhc2tzOiBSZW5hbWVUYXNrW11cclxufVxyXG5cclxuaW50ZXJmYWNlIFJlbmFtZVRhc2sge1xyXG5cdGZpbGU6IFRGaWxlXHJcblx0bmFtZTogc3RyaW5nXHJcbn1cclxuXHJcbnR5cGUgcmVuYW1lRnVuY1R5cGUgPSAoZmlsZTogVEZpbGUsIG5hbWU6IHN0cmluZykgPT4gUHJvbWlzZTx2b2lkPlxyXG5cclxuZXhwb3J0IGNsYXNzIEltYWdlQmF0Y2hSZW5hbWVNb2RhbCBleHRlbmRzIE1vZGFsIHtcclxuXHRhY3RpdmVGaWxlOiBURmlsZVxyXG5cdHJlbmFtZUZ1bmM6IHJlbmFtZUZ1bmNUeXBlXHJcblx0b25DbG9zZUV4dHJhOiAoKSA9PiB2b2lkXHJcblx0c3RhdGU6IFN0YXRlXHJcblxyXG5cdGNvbnN0cnVjdG9yKGFwcDogQXBwLCBhY3RpdmVGaWxlOiBURmlsZSwgcmVuYW1lRnVuYzogcmVuYW1lRnVuY1R5cGUsIG9uQ2xvc2U6ICgpID0+IHZvaWQpIHtcclxuXHRcdHN1cGVyKGFwcCk7XHJcblx0XHR0aGlzLmFjdGl2ZUZpbGUgPSBhY3RpdmVGaWxlXHJcblx0XHR0aGlzLnJlbmFtZUZ1bmMgPSByZW5hbWVGdW5jXHJcblx0XHR0aGlzLm9uQ2xvc2VFeHRyYSA9IG9uQ2xvc2VcclxuXHJcblx0XHR0aGlzLnN0YXRlID0ge1xyXG5cdFx0XHRuYW1lUGF0dGVybjogJycsXHJcblx0XHRcdGV4dFBhdHRlcm46ICcnLFxyXG5cdFx0XHRuYW1lUmVwbGFjZTogJycsXHJcblx0XHRcdHJlbmFtZVRhc2tzOiBbXSxcclxuXHRcdH1cclxuXHR9XHJcblxyXG5cdG9uT3BlbigpIHtcclxuXHRcdHRoaXMuY29udGFpbmVyRWwuYWRkQ2xhc3MoJ2ltYWdlLXJlbmFtZS1tb2RhbCcpXHJcblx0XHRjb25zdCB7IGNvbnRlbnRFbCwgdGl0bGVFbCB9ID0gdGhpcztcclxuXHRcdHRpdGxlRWwuc2V0VGV4dCgnQmF0Y2ggcmVuYW1lIGVtYmVkZWQgZmlsZXMnKVxyXG5cclxuXHRcdGNvbnN0IG5hbWVQYXR0ZXJuU2V0dGluZyA9IG5ldyBTZXR0aW5nKGNvbnRlbnRFbClcclxuXHRcdFx0LnNldE5hbWUoJ05hbWUgcGF0dGVybicpXHJcblx0XHRcdC5zZXREZXNjKCdQbGVhc2UgaW5wdXQgdGhlIG5hbWUgcGF0dGVybiB0byBtYXRjaCBmaWxlcyAocmVnZXgpJylcclxuXHRcdFx0LmFkZFRleHQodGV4dCA9PiB0ZXh0XHJcblx0XHRcdFx0LnNldFZhbHVlKHRoaXMuc3RhdGUubmFtZVBhdHRlcm4pXHJcblx0XHRcdFx0Lm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xyXG5cdFx0XHRcdFx0dGhpcy5zdGF0ZS5uYW1lUGF0dGVybiA9IHZhbHVlXHJcblx0XHRcdFx0fVxyXG5cdFx0XHRcdCkpXHJcblx0XHRjb25zdCBucElucHV0RWwgPSBuYW1lUGF0dGVyblNldHRpbmcuY29udHJvbEVsLmNoaWxkcmVuWzBdIGFzIEhUTUxJbnB1dEVsZW1lbnRcclxuXHRcdG5wSW5wdXRFbC5mb2N1cygpXHJcblx0XHRjb25zdCBucElucHV0U3RhdGUgPSBsb2NrSW5wdXRNZXRob2RDb21wb3NpdGlvbihucElucHV0RWwpXHJcblx0XHRucElucHV0RWwuYWRkRXZlbnRMaXN0ZW5lcigna2V5ZG93bicsIGFzeW5jIChlKSA9PiB7XHJcblx0XHRcdGlmIChlLmtleSA9PT0gJ0VudGVyJyAmJiAhbnBJbnB1dFN0YXRlLmxvY2spIHtcclxuXHRcdFx0XHRlLnByZXZlbnREZWZhdWx0KClcclxuXHRcdFx0XHRpZiAoIXRoaXMuc3RhdGUubmFtZVBhdHRlcm4pIHtcclxuXHRcdFx0XHRcdGVycm9yRWwuaW5uZXJUZXh0ID0gJ0Vycm9yOiBcIk5hbWUgcGF0dGVyblwiIGNvdWxkIG5vdCBiZSBlbXB0eSdcclxuXHRcdFx0XHRcdGVycm9yRWwuc3R5bGUuZGlzcGxheSA9ICdibG9jaydcclxuXHRcdFx0XHRcdHJldHVyblxyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHR0aGlzLm1hdGNoSW1hZ2VOYW1lcyh0Ym9keUVsKVxyXG5cdFx0XHR9XHJcblx0XHR9KVxyXG5cclxuXHRcdGNvbnN0IGV4dFBhdHRlcm5TZXR0aW5nID0gbmV3IFNldHRpbmcoY29udGVudEVsKVxyXG5cdFx0XHQuc2V0TmFtZSgnRXh0ZW5zaW9uIHBhdHRlcm4nKVxyXG5cdFx0XHQuc2V0RGVzYygnUGxlYXNlIGlucHV0IHRoZSBleHRlbnNpb24gcGF0dGVybiB0byBtYXRjaCBmaWxlcyAocmVnZXgpJylcclxuXHRcdFx0LmFkZFRleHQodGV4dCA9PiB0ZXh0XHJcblx0XHRcdFx0LnNldFZhbHVlKHRoaXMuc3RhdGUuZXh0UGF0dGVybilcclxuXHRcdFx0XHQub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XHJcblx0XHRcdFx0XHR0aGlzLnN0YXRlLmV4dFBhdHRlcm4gPSB2YWx1ZVxyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHQpKVxyXG5cdFx0Y29uc3QgZXh0SW5wdXRFbCA9IGV4dFBhdHRlcm5TZXR0aW5nLmNvbnRyb2xFbC5jaGlsZHJlblswXSBhcyBIVE1MSW5wdXRFbGVtZW50XHJcblx0XHRleHRJbnB1dEVsLmFkZEV2ZW50TGlzdGVuZXIoJ2tleWRvd24nLCBhc3luYyAoZSkgPT4ge1xyXG5cdFx0XHRpZiAoZS5rZXkgPT09ICdFbnRlcicpIHtcclxuXHRcdFx0XHRlLnByZXZlbnREZWZhdWx0KClcclxuXHRcdFx0XHR0aGlzLm1hdGNoSW1hZ2VOYW1lcyh0Ym9keUVsKVxyXG5cdFx0XHR9XHJcblx0XHR9KVxyXG5cclxuXHRcdGNvbnN0IG5hbWVSZXBsYWNlU2V0dGluZyA9IG5ldyBTZXR0aW5nKGNvbnRlbnRFbClcclxuXHRcdFx0LnNldE5hbWUoJ05hbWUgcmVwbGFjZScpXHJcblx0XHRcdC5zZXREZXNjKCdQbGVhc2UgaW5wdXQgdGhlIHN0cmluZyB0byByZXBsYWNlIHRoZSBtYXRjaGVkIG5hbWUgKHVzZSAkMSwgJDIgZm9yIHJlZ2V4IGdyb3VwcyknKVxyXG5cdFx0XHQuYWRkVGV4dCh0ZXh0ID0+IHRleHRcclxuXHRcdFx0XHQuc2V0VmFsdWUodGhpcy5zdGF0ZS5uYW1lUmVwbGFjZSlcclxuXHRcdFx0XHQub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XHJcblx0XHRcdFx0XHR0aGlzLnN0YXRlLm5hbWVSZXBsYWNlID0gdmFsdWVcclxuXHRcdFx0XHR9XHJcblx0XHRcdFx0KSlcclxuXHJcblx0XHRjb25zdCBucklucHV0RWwgPSBuYW1lUmVwbGFjZVNldHRpbmcuY29udHJvbEVsLmNoaWxkcmVuWzBdIGFzIEhUTUxJbnB1dEVsZW1lbnRcclxuXHRcdGNvbnN0IG5ySW5wdXRTdGF0ZSA9IGxvY2tJbnB1dE1ldGhvZENvbXBvc2l0aW9uKG5ySW5wdXRFbClcclxuXHRcdG5ySW5wdXRFbC5hZGRFdmVudExpc3RlbmVyKCdrZXlkb3duJywgYXN5bmMgKGUpID0+IHtcclxuXHRcdFx0aWYgKGUua2V5ID09PSAnRW50ZXInICYmICFucklucHV0U3RhdGUubG9jaykge1xyXG5cdFx0XHRcdGUucHJldmVudERlZmF1bHQoKVxyXG5cdFx0XHRcdHRoaXMubWF0Y2hJbWFnZU5hbWVzKHRib2R5RWwpXHJcblx0XHRcdH1cclxuXHRcdH0pXHJcblxyXG5cclxuXHRcdGNvbnN0IG1hdGNoZWRDb250YWluZXIgPSBjb250ZW50RWwuY3JlYXRlRGl2KHtcclxuXHRcdFx0Y2xzOiAnbWF0Y2hlZC1jb250YWluZXInLFxyXG5cdFx0fSlcclxuXHRcdGNvbnN0IHRhYmxlRVQgPSBjcmVhdGVFbGVtZW50VHJlZShtYXRjaGVkQ29udGFpbmVyLCB7XHJcblx0XHRcdHRhZzogJ3RhYmxlJyxcclxuXHRcdFx0Y2hpbGRyZW46IFtcclxuXHRcdFx0XHR7XHJcblx0XHRcdFx0XHR0YWc6ICd0aGVhZCcsXHJcblx0XHRcdFx0XHRjaGlsZHJlbjogW1xyXG5cdFx0XHRcdFx0XHR7XHJcblx0XHRcdFx0XHRcdFx0dGFnOiAndHInLFxyXG5cdFx0XHRcdFx0XHRcdGNoaWxkcmVuOiBbXHJcblx0XHRcdFx0XHRcdFx0XHR7XHJcblx0XHRcdFx0XHRcdFx0XHRcdHRhZzogJ3RkJyxcclxuXHRcdFx0XHRcdFx0XHRcdFx0dGV4dDogJ09yaWdpbmFsIHBhdGgnLFxyXG5cdFx0XHRcdFx0XHRcdFx0fSxcclxuXHRcdFx0XHRcdFx0XHRcdHtcclxuXHRcdFx0XHRcdFx0XHRcdFx0dGFnOiAndGQnLFxyXG5cdFx0XHRcdFx0XHRcdFx0XHR0ZXh0OiAnUmVuYW1lZCBOYW1lJyxcclxuXHRcdFx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdFx0XHRdXHJcblx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdF1cclxuXHRcdFx0XHR9LFxyXG5cdFx0XHRcdHtcclxuXHRcdFx0XHRcdHRhZzogJ3Rib2R5JyxcclxuXHRcdFx0XHR9XHJcblx0XHRcdF1cclxuXHRcdH0pXHJcblx0XHRjb25zdCB0Ym9keUVsID0gdGFibGVFVC5jaGlsZHJlblsxXS5lbFxyXG5cclxuXHRcdGNvbnN0IGVycm9yRWwgPSBjb250ZW50RWwuY3JlYXRlRGl2KHtcclxuXHRcdFx0Y2xzOiAnZXJyb3InLFxyXG5cdFx0XHRhdHRyOiB7XHJcblx0XHRcdFx0c3R5bGU6ICdkaXNwbGF5OiBub25lOycsXHJcblx0XHRcdH1cclxuXHRcdH0pXHJcblxyXG5cdFx0bmV3IFNldHRpbmcoY29udGVudEVsKVxyXG5cdFx0XHQuYWRkQnV0dG9uKGJ1dHRvbiA9PiB7XHJcblx0XHRcdFx0YnV0dG9uXHJcblx0XHRcdFx0XHQuc2V0QnV0dG9uVGV4dCgnUmVuYW1lIGFsbCcpXHJcblx0XHRcdFx0XHQuc2V0Q2xhc3MoJ21vZC1jdGEnKVxyXG5cdFx0XHRcdFx0Lm9uQ2xpY2soKCkgPT4ge1xyXG5cdFx0XHRcdFx0XHRuZXcgQ29uZmlybU1vZGFsKFxyXG5cdFx0XHRcdFx0XHRcdHRoaXMuYXBwLFxyXG5cdFx0XHRcdFx0XHRcdCdDb25maXJtIHJlbmFtZSBhbGwnLFxyXG5cdFx0XHRcdFx0XHRcdGBBcmUgeW91IHN1cmU/IFRoaXMgd2lsbCByZW5hbWUgYWxsIHRoZSAke3RoaXMuc3RhdGUucmVuYW1lVGFza3MubGVuZ3RofSBpbWFnZXMgbWF0Y2hlZCB0aGUgcGF0dGVybi5gLFxyXG5cdFx0XHRcdFx0XHRcdCgpID0+IHtcclxuXHRcdFx0XHRcdFx0XHRcdHRoaXMucmVuYW1lQWxsKClcclxuXHRcdFx0XHRcdFx0XHRcdHRoaXMuY2xvc2UoKVxyXG5cdFx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdFx0KS5vcGVuKClcclxuXHRcdFx0XHRcdH0pXHJcblx0XHRcdH0pXHJcblx0XHRcdC5hZGRCdXR0b24oYnV0dG9uID0+IHtcclxuXHRcdFx0XHRidXR0b25cclxuXHRcdFx0XHRcdC5zZXRCdXR0b25UZXh0KCdDYW5jZWwnKVxyXG5cdFx0XHRcdFx0Lm9uQ2xpY2soKCkgPT4geyB0aGlzLmNsb3NlKCkgfSlcclxuXHRcdFx0fSlcclxuXHR9XHJcblxyXG5cdG9uQ2xvc2UoKSB7XHJcblx0XHRjb25zdCB7IGNvbnRlbnRFbCB9ID0gdGhpcztcclxuXHRcdGNvbnRlbnRFbC5lbXB0eSgpO1xyXG5cdFx0dGhpcy5vbkNsb3NlRXh0cmEoKVxyXG5cdH1cclxuXHJcblx0YXN5bmMgcmVuYW1lQWxsKCkge1xyXG5cdFx0ZGVidWdMb2coJ3JlbmFtZUFsbCcsIHRoaXMuc3RhdGUpXHJcblx0XHRmb3IgKGNvbnN0IHRhc2sgb2YgdGhpcy5zdGF0ZS5yZW5hbWVUYXNrcykge1xyXG5cdFx0XHRhd2FpdCB0aGlzLnJlbmFtZUZ1bmModGFzay5maWxlLCB0YXNrLm5hbWUpXHJcblx0XHR9XHJcblx0fVxyXG5cclxuXHRtYXRjaEltYWdlTmFtZXModGJvZHlFbDogSFRNTEVsZW1lbnQpIHtcclxuXHRcdGNvbnN0IHsgc3RhdGUgfSA9IHRoaXNcclxuXHRcdGNvbnN0IHJlbmFtZVRhc2tzOiBSZW5hbWVUYXNrW10gPSBbXVxyXG5cdFx0dGJvZHlFbC5lbXB0eSgpXHJcblx0XHRjb25zdCBmaWxlQ2FjaGUgPSB0aGlzLmFwcC5tZXRhZGF0YUNhY2hlLmdldEZpbGVDYWNoZSh0aGlzLmFjdGl2ZUZpbGUpXHJcblx0XHRpZiAoIWZpbGVDYWNoZSB8fCAhZmlsZUNhY2hlLmVtYmVkcykgcmV0dXJuXHJcblxyXG5cdFx0Y29uc3QgbmFtZVBhdHRlcm5SZWdleCA9IG5ldyBSZWdFeHAoc3RhdGUubmFtZVBhdHRlcm4sICdnJylcclxuXHRcdGNvbnN0IGV4dFBhdHRlcm5SZWdleCA9IG5ldyBSZWdFeHAoc3RhdGUuZXh0UGF0dGVybilcclxuXHRcdGZpbGVDYWNoZS5lbWJlZHMuZm9yRWFjaChlbWJlZCA9PiB7XHJcblx0XHRcdGNvbnN0IGZpbGUgPSB0aGlzLmFwcC5tZXRhZGF0YUNhY2hlLmdldEZpcnN0TGlua3BhdGhEZXN0KGVtYmVkLmxpbmssIHRoaXMuYWN0aXZlRmlsZS5wYXRoKVxyXG5cdFx0XHRpZiAoIWZpbGUpIHtcclxuXHRcdFx0XHRjb25zb2xlLndhcm4oJ2ZpbGUgbm90IGZvdW5kJywgZW1iZWQubGluaylcclxuXHRcdFx0XHRyZXR1cm5cclxuXHRcdFx0fVxyXG5cdFx0XHQvLyBtYXRjaCBleHQgKG9ubHkgaWYgZXh0UGF0dGVybiBpcyBub3QgZW1wdHkpXHJcblx0XHRcdGlmIChzdGF0ZS5leHRQYXR0ZXJuKSB7XHJcblx0XHRcdFx0Y29uc3QgbTAgPSBleHRQYXR0ZXJuUmVnZXguZXhlYyhmaWxlLmV4dGVuc2lvbilcclxuXHRcdFx0XHRpZiAoIW0wKSByZXR1cm5cclxuXHRcdFx0fVxyXG5cclxuXHRcdFx0Ly8gbWF0Y2ggc3RlbVxyXG5cdFx0XHRjb25zdCBzdGVtID0gZmlsZS5iYXNlbmFtZVxyXG5cdFx0XHRuYW1lUGF0dGVyblJlZ2V4Lmxhc3RJbmRleCA9IDBcclxuXHRcdFx0Y29uc3QgbTEgPSBuYW1lUGF0dGVyblJlZ2V4LmV4ZWMoc3RlbSlcclxuXHRcdFx0aWYgKCFtMSkgcmV0dXJuXHJcblxyXG5cdFx0XHRsZXQgcmVuYW1lZE5hbWUgPSBmaWxlLm5hbWVcclxuXHRcdFx0aWYgKHN0YXRlLm5hbWVSZXBsYWNlKSB7XHJcblx0XHRcdFx0bmFtZVBhdHRlcm5SZWdleC5sYXN0SW5kZXggPSAwXHJcblx0XHRcdFx0cmVuYW1lZE5hbWUgPSBzdGVtLnJlcGxhY2UobmFtZVBhdHRlcm5SZWdleCwgc3RhdGUubmFtZVJlcGxhY2UpXHJcblx0XHRcdFx0cmVuYW1lZE5hbWUgPSBgJHtyZW5hbWVkTmFtZX0uJHtmaWxlLmV4dGVuc2lvbn1gXHJcblx0XHRcdH1cclxuXHRcdFx0cmVuYW1lVGFza3MucHVzaCh7XHJcblx0XHRcdFx0ZmlsZSxcclxuXHRcdFx0XHRuYW1lOiByZW5hbWVkTmFtZSxcclxuXHRcdFx0fSlcclxuXHJcblx0XHRcdGNyZWF0ZUVsZW1lbnRUcmVlKHRib2R5RWwsIHtcclxuXHRcdFx0XHR0YWc6ICd0cicsXHJcblx0XHRcdFx0Y2hpbGRyZW46IFtcclxuXHRcdFx0XHRcdHtcclxuXHRcdFx0XHRcdFx0dGFnOiAndGQnLFxyXG5cdFx0XHRcdFx0XHRjaGlsZHJlbjogW1xyXG5cdFx0XHRcdFx0XHRcdHtcclxuXHRcdFx0XHRcdFx0XHRcdHRhZzogJ3NwYW4nLFxyXG5cdFx0XHRcdFx0XHRcdFx0dGV4dDogZmlsZS5uYW1lLFxyXG5cdFx0XHRcdFx0XHRcdH0sXHJcblx0XHRcdFx0XHRcdFx0e1xyXG5cdFx0XHRcdFx0XHRcdFx0dGFnOiAnZGl2JyxcclxuXHRcdFx0XHRcdFx0XHRcdHRleHQ6IGZpbGUucGF0aCxcclxuXHRcdFx0XHRcdFx0XHRcdGF0dHI6IHtcclxuXHRcdFx0XHRcdFx0XHRcdFx0Y2xhc3M6ICdmaWxlLXBhdGgnLFxyXG5cdFx0XHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdFx0XVxyXG5cdFx0XHRcdFx0fSxcclxuXHRcdFx0XHRcdHtcclxuXHRcdFx0XHRcdFx0dGFnOiAndGQnLFxyXG5cdFx0XHRcdFx0XHRjaGlsZHJlbjogW1xyXG5cdFx0XHRcdFx0XHRcdHtcclxuXHRcdFx0XHRcdFx0XHRcdHRhZzogJ3NwYW4nLFxyXG5cdFx0XHRcdFx0XHRcdFx0dGV4dDogcmVuYW1lZE5hbWUsXHJcblx0XHRcdFx0XHRcdFx0fSxcclxuXHRcdFx0XHRcdFx0XHR7XHJcblx0XHRcdFx0XHRcdFx0XHR0YWc6ICdkaXYnLFxyXG5cdFx0XHRcdFx0XHRcdFx0dGV4dDogcGF0aC5qb2luKGZpbGUucGFyZW50LnBhdGgsIHJlbmFtZWROYW1lKSxcclxuXHRcdFx0XHRcdFx0XHRcdGF0dHI6IHtcclxuXHRcdFx0XHRcdFx0XHRcdFx0Y2xhc3M6ICdmaWxlLXBhdGgnLFxyXG5cdFx0XHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdFx0XVxyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdF1cclxuXHJcblx0XHRcdH0pXHJcblx0XHR9KVxyXG5cclxuXHRcdGRlYnVnTG9nKCduZXcgcmVuYW1lVGFza3MnLCByZW5hbWVUYXNrcylcclxuXHRcdHN0YXRlLnJlbmFtZVRhc2tzID0gcmVuYW1lVGFza3NcclxuXHR9XHJcbn1cclxuXHJcblxyXG5jbGFzcyBDb25maXJtTW9kYWwgZXh0ZW5kcyBNb2RhbCB7XHJcblx0dGl0bGU6IHN0cmluZ1xyXG5cdG1lc3NhZ2U6IHN0cmluZ1xyXG5cdG9uQ29uZmlybTogKCkgPT4gdm9pZFxyXG5cclxuXHRjb25zdHJ1Y3RvcihhcHA6IEFwcCwgdGl0bGU6IHN0cmluZywgbWVzc2FnZTogc3RyaW5nLCBvbkNvbmZpcm06ICgpID0+IHZvaWQpIHtcclxuXHRcdHN1cGVyKGFwcCk7XHJcblx0XHR0aGlzLnRpdGxlID0gdGl0bGVcclxuXHRcdHRoaXMubWVzc2FnZSA9IG1lc3NhZ2VcclxuXHRcdHRoaXMub25Db25maXJtID0gb25Db25maXJtXHJcblx0fVxyXG5cclxuXHRvbk9wZW4oKTogdm9pZCB7XHJcblx0XHRjb25zdCB7IGNvbnRlbnRFbCwgdGl0bGVFbCB9ID0gdGhpcztcclxuXHRcdHRpdGxlRWwuc2V0VGV4dCh0aGlzLnRpdGxlKVxyXG5cdFx0Y29udGVudEVsLmNyZWF0ZUVsKCdwJywge1xyXG5cdFx0XHR0ZXh0OiB0aGlzLm1lc3NhZ2UsXHJcblx0XHR9KVxyXG5cclxuXHRcdG5ldyBTZXR0aW5nKGNvbnRlbnRFbClcclxuXHRcdFx0LmFkZEJ1dHRvbihidXR0b24gPT4ge1xyXG5cdFx0XHRcdGJ1dHRvblxyXG5cdFx0XHRcdFx0LnNldEJ1dHRvblRleHQoJ1llcycpXHJcblx0XHRcdFx0XHQuc2V0Q2xhc3MoJ21vZC13YXJuaW5nJylcclxuXHRcdFx0XHRcdC5vbkNsaWNrKCgpID0+IHtcclxuXHRcdFx0XHRcdFx0dGhpcy5vbkNvbmZpcm0oKVxyXG5cdFx0XHRcdFx0XHR0aGlzLmNsb3NlKClcclxuXHRcdFx0XHRcdH0pXHJcblx0XHRcdH0pXHJcblx0XHRcdC5hZGRCdXR0b24oYnV0dG9uID0+IHtcclxuXHRcdFx0XHRidXR0b25cclxuXHRcdFx0XHRcdC5zZXRCdXR0b25UZXh0KCdObycpXHJcblx0XHRcdFx0XHQub25DbGljaygoKSA9PiB7IHRoaXMuY2xvc2UoKSB9KVxyXG5cdFx0XHR9KVxyXG5cdH1cclxufVxyXG4iLCAiaW1wb3J0IHtcclxuICBBcHAsXHJcbiAgVmF1bHQsXHJcbn0gZnJvbSAnb2JzaWRpYW4nO1xyXG5cclxuZXhwb3J0IGNvbnN0IERFQlVHID0gIShwcm9jZXNzLmVudi5CVUlMRF9FTlYgPT09ICdwcm9kdWN0aW9uJylcclxuaWYgKERFQlVHKSBjb25zb2xlLmxvZygnREVCVUcgaXMgZW5hYmxlZCcpXHJcblxyXG5leHBvcnQgZnVuY3Rpb24gZGVidWdMb2coLi4uYXJnczogYW55W10pIHtcclxuXHRpZiAoREVCVUcpIHtcclxuXHRcdGNvbnNvbGUubG9nKChuZXcgRGF0ZSgpKS50b0lTT1N0cmluZygpLnNsaWNlKDExLCAyMyksIC4uLmFyZ3MpXHJcblx0fVxyXG59XHJcblxyXG5pbnRlcmZhY2UgRWxlbWVudFRyZWVPcHRpb25zIGV4dGVuZHMgRG9tRWxlbWVudEluZm8ge1xyXG5cdHRhZzoga2V5b2YgSFRNTEVsZW1lbnRUYWdOYW1lTWFwXHJcblx0Y2hpbGRyZW4/OiBFbGVtZW50VHJlZU9wdGlvbnNbXVxyXG59XHJcblxyXG5pbnRlcmZhY2UgRWxlbWVudFRyZWUge1xyXG5cdGVsOiBIVE1MRWxlbWVudFxyXG5cdGNoaWxkcmVuOiBFbGVtZW50VHJlZVtdXHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBjcmVhdGVFbGVtZW50VHJlZShyb290RWw6IEhUTUxFbGVtZW50LCBvcHRzOiBFbGVtZW50VHJlZU9wdGlvbnMpOiBFbGVtZW50VHJlZSB7XHJcblx0Y29uc3QgcmVzdWx0OiBFbGVtZW50VHJlZSA9IHtcclxuXHRcdGVsOiByb290RWwuY3JlYXRlRWwob3B0cy50YWcsIG9wdHMgYXMgRG9tRWxlbWVudEluZm8pLFxyXG5cdFx0Y2hpbGRyZW46IFtdLFxyXG5cdH1cclxuXHRjb25zdCBjaGlsZHJlbiA9IG9wdHMuY2hpbGRyZW4gfHwgW11cclxuXHRmb3IgKGNvbnN0IGNoaWxkIG9mIGNoaWxkcmVuKSB7XHJcblx0XHRyZXN1bHQuY2hpbGRyZW4ucHVzaChjcmVhdGVFbGVtZW50VHJlZShyZXN1bHQuZWwsIGNoaWxkKSlcclxuXHR9XHJcblx0cmV0dXJuIHJlc3VsdFxyXG59XHJcblxyXG5leHBvcnQgY29uc3QgcGF0aCA9IHtcclxuXHQvLyBDcmVkaXQ6IEBjcmVhdGlvbml4L3BhdGguanNcclxuXHRqb2luKC4uLnBhcnRTZWdtZW50czogc3RyaW5nW10pOiBzdHJpbmcge1xyXG5cdFx0Ly8gU3BsaXQgdGhlIGlucHV0cyBpbnRvIGEgbGlzdCBvZiBwYXRoIGNvbW1hbmRzLlxyXG5cdFx0bGV0IHBhcnRzOiBzdHJpbmdbXSA9IFtdXHJcblx0XHRmb3IgKGxldCBpID0gMCwgbCA9IHBhcnRTZWdtZW50cy5sZW5ndGg7IGkgPCBsOyBpKyspIHtcclxuXHRcdFx0cGFydHMgPSBwYXJ0cy5jb25jYXQocGFydFNlZ21lbnRzW2ldLnNwbGl0KCcvJykpXHJcblx0XHR9XHJcblx0XHQvLyBJbnRlcnByZXQgdGhlIHBhdGggY29tbWFuZHMgdG8gZ2V0IHRoZSBuZXcgcmVzb2x2ZWQgcGF0aC5cclxuXHRcdGNvbnN0IG5ld1BhcnRzID0gW11cclxuXHRcdGZvciAobGV0IGkgPSAwLCBsID0gcGFydHMubGVuZ3RoOyBpIDwgbDsgaSsrKSB7XHJcblx0XHRcdGNvbnN0IHBhcnQgPSBwYXJ0c1tpXVxyXG5cdFx0XHQvLyBSZW1vdmUgbGVhZGluZyBhbmQgdHJhaWxpbmcgc2xhc2hlc1xyXG5cdFx0XHQvLyBBbHNvIHJlbW92ZSBcIi5cIiBzZWdtZW50c1xyXG5cdFx0XHRpZiAoIXBhcnQgfHwgcGFydCA9PT0gJy4nKSBjb250aW51ZVxyXG5cdFx0XHQvLyBQdXNoIG5ldyBwYXRoIHNlZ21lbnRzLlxyXG5cdFx0XHRlbHNlIG5ld1BhcnRzLnB1c2gocGFydClcclxuXHRcdH1cclxuXHRcdC8vIFByZXNlcnZlIHRoZSBpbml0aWFsIHNsYXNoIGlmIHRoZXJlIHdhcyBvbmUuXHJcblx0XHRpZiAocGFydHNbMF0gPT09ICcnKSBuZXdQYXJ0cy51bnNoaWZ0KCcnKVxyXG5cdFx0Ly8gVHVybiBiYWNrIGludG8gYSBzaW5nbGUgc3RyaW5nIHBhdGguXHJcblx0XHRyZXR1cm4gbmV3UGFydHMuam9pbignLycpXHJcblx0fSxcclxuXHJcblx0Ly8gcmV0dXJucyB0aGUgbGFzdCBwYXJ0IG9mIGEgcGF0aCwgZS5nLiAnZm9vLmpwZydcclxuXHRiYXNlbmFtZShmdWxscGF0aDogc3RyaW5nKTogc3RyaW5nIHtcclxuXHRcdGNvbnN0IHNwID0gZnVsbHBhdGguc3BsaXQoJy8nKVxyXG5cdFx0cmV0dXJuIHNwW3NwLmxlbmd0aCAtIDFdXHJcblx0fSxcclxuXHJcblx0Ly8gcmV0dXJuIGV4dGVuc2lvbiB3aXRob3V0IGRvdCwgZS5nLiAnanBnJ1xyXG5cdGV4dGVuc2lvbihmdWxscGF0aDogc3RyaW5nKTogc3RyaW5nIHtcclxuXHRcdGNvbnN0IHBvc2l0aW9ucyA9IFsuLi5mdWxscGF0aC5tYXRjaEFsbChuZXcgUmVnRXhwKCdcXFxcLicsICdnaScpKV0ubWFwKGEgPT4gYS5pbmRleClcclxuXHRcdHJldHVybiBmdWxscGF0aC5zbGljZShwb3NpdGlvbnNbcG9zaXRpb25zLmxlbmd0aCAtIDFdICsgMSlcclxuXHR9LFxyXG59XHJcblxyXG5jb25zdCBmaWxlbmFtZU5vdEFsbG93ZWRDaGFycyA9IC9bXlxccHtMfTAtOX5gIUAkJiooKVxcLV89K3t9OydcIiw8Lj4/IF0vdWdcclxuXHJcbmV4cG9ydCBjb25zdCBzYW5pdGl6ZXIgPSB7XHJcblx0ZmlsZW5hbWUoczogc3RyaW5nKTogc3RyaW5nIHtcclxuXHRcdHJldHVybiBzLnJlcGxhY2UoZmlsZW5hbWVOb3RBbGxvd2VkQ2hhcnMsICcnKS50cmltKClcclxuXHR9LFxyXG5cclxuXHRkZWxpbWl0ZXIoczogc3RyaW5nKTogc3RyaW5nIHtcclxuXHRcdHMgPSB0aGlzLmZpbGVuYW1lKHMpXHJcblx0XHQvLyB1c2UgZGVmYXVsdCAnLScgaWYgbm8gdmFsaWQgY2hhcnMgZm91bmRcclxuXHRcdGlmICghcykgcyA9ICctJ1xyXG5cdFx0cmV0dXJuIHNcclxuXHR9XHJcbn1cclxuXHJcbi8vIHJlZjogaHR0cHM6Ly9zdGFja292ZXJmbG93LmNvbS9hLzY5Njk0ODYvNTk2MjA2XHJcbmV4cG9ydCBmdW5jdGlvbiBlc2NhcGVSZWdFeHAoczogc3RyaW5nKSB7XHJcbiAgICByZXR1cm4gcy5yZXBsYWNlKC9bLiorP14ke30oKXxbXFxdXFxcXF0vZywgJ1xcXFwkJicpO1xyXG59XHJcblxyXG5cclxuaW50ZXJmYWNlIENvbXBvc2l0aW9uU3RhdGUge1xyXG5cdGxvY2s6IGJvb2xlYW5cclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGxvY2tJbnB1dE1ldGhvZENvbXBvc2l0aW9uKGVsOiBIVE1MSW5wdXRFbGVtZW50KTogQ29tcG9zaXRpb25TdGF0ZSB7XHJcblx0Y29uc3Qgc3RhdGU6IENvbXBvc2l0aW9uU3RhdGUgPSB7XHJcblx0XHRsb2NrOiBmYWxzZSxcclxuXHR9XHJcblx0ZWwuYWRkRXZlbnRMaXN0ZW5lcignY29tcG9zaXRpb25zdGFydCcsICgpID0+IHtcclxuXHRcdHN0YXRlLmxvY2sgPSB0cnVlXHJcblx0fSlcclxuXHRlbC5hZGRFdmVudExpc3RlbmVyKCdjb21wb3NpdGlvbmVuZCcsICgpID0+IHtcclxuXHRcdHN0YXRlLmxvY2sgPSBmYWxzZVxyXG5cdH0pXHJcblx0cmV0dXJuIHN0YXRlXHJcbn1cclxuXHJcblxyXG5pbnRlcmZhY2UgVmF1bHRDb25maWcge1xyXG5cdHVzZU1hcmtkb3duTGlua3M/OiBib29sZWFuXHJcbn1cclxuXHJcbmludGVyZmFjZSBWYXVsdFdpdGhDb25maWcgZXh0ZW5kcyBWYXVsdCB7XHJcblx0Y29uZmlnPzogVmF1bHRDb25maWcsXHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBnZXRWYXVsdENvbmZpZyhhcHA6IEFwcCk6IFZhdWx0Q29uZmlnfG51bGwge1xyXG5cdGNvbnN0IHZhdWx0ID0gYXBwLnZhdWx0IGFzIFZhdWx0V2l0aENvbmZpZ1xyXG5cdHJldHVybiB2YXVsdC5jb25maWdcclxufVxyXG5cclxuZXhwb3J0IGludGVyZmFjZSBOYW1lT2JqIHtcclxuXHRuYW1lOiBzdHJpbmdcclxuXHRzdGVtOiBzdHJpbmdcclxuXHRleHRlbnNpb246IHN0cmluZ1xyXG59XHJcbiIsICJpbXBvcnQgeyBGcm9udE1hdHRlckNhY2hlIH0gZnJvbSAnb2JzaWRpYW4nO1xyXG5cclxuY29uc3QgZGF0ZVRtcGxSZWdleCA9IC97e0RBVEU6KFtefV0rKX19L2dtXHJcbmNvbnN0IGZyb250bWF0dGVyVG1wbFJlZ2V4ID0gL3t7ZnJvbnRtYXR0ZXI6KFtefV0rKX19L2dtXHJcblxyXG5jb25zdCByZXBsYWNlRGF0ZVZhciA9IChzOiBzdHJpbmcsIGRhdGU6IG1vbWVudC5Nb21lbnQpOiBzdHJpbmcgPT4ge1xyXG5cdGNvbnN0IG0gPSBkYXRlVG1wbFJlZ2V4LmV4ZWMocylcclxuXHRpZiAoIW0pIHJldHVybiBzXHJcblx0cmV0dXJuIHMucmVwbGFjZShtWzBdLCBkYXRlLmZvcm1hdChtWzFdKSlcclxufVxyXG5cclxuY29uc3QgcmVwbGFjZUZyb250bWF0dGVyVmFyID0gKHM6IHN0cmluZywgZnJvbnRtYXR0ZXI/OiBGcm9udE1hdHRlckNhY2hlKTogc3RyaW5nID0+IHtcclxuXHRpZiAoIWZyb250bWF0dGVyKSByZXR1cm4gc1xyXG5cdGNvbnN0IG0gPSBmcm9udG1hdHRlclRtcGxSZWdleC5leGVjKHMpXHJcblx0aWYgKCFtKSByZXR1cm4gc1xyXG5cdHJldHVybiBzLnJlcGxhY2UobVswXSwgZnJvbnRtYXR0ZXJbbVsxXV0gfHwgJycpXHJcbn1cclxuXHJcbmludGVyZmFjZSBUZW1wbGF0ZURhdGEge1xyXG5cdGltYWdlTmFtZUtleTogc3RyaW5nXHJcblx0ZmlsZU5hbWU6IHN0cmluZ1xyXG5cdGRpck5hbWU6IHN0cmluZ1xyXG5cdGZpcnN0SGVhZGluZzogc3RyaW5nXHJcbn1cclxuXHJcbmV4cG9ydCBjb25zdCByZW5kZXJUZW1wbGF0ZSA9ICh0bXBsOiBzdHJpbmcsIGRhdGE6IFRlbXBsYXRlRGF0YSwgZnJvbnRtYXR0ZXI/OiBGcm9udE1hdHRlckNhY2hlKSA9PiB7XHJcblx0Y29uc3Qgbm93ID0gd2luZG93Lm1vbWVudCgpXHJcblx0bGV0IHRleHQgPSB0bXBsXHJcblx0bGV0IG5ld3RleHRcclxuXHR3aGlsZSAoKG5ld3RleHQgPSByZXBsYWNlRGF0ZVZhcih0ZXh0LCBub3cpKSAhPSB0ZXh0KSB7XHJcblx0XHR0ZXh0ID0gbmV3dGV4dFxyXG5cdH1cclxuXHR3aGlsZSAoKG5ld3RleHQgPSByZXBsYWNlRnJvbnRtYXR0ZXJWYXIodGV4dCwgZnJvbnRtYXR0ZXIpKSAhPSB0ZXh0KSB7XHJcblx0XHR0ZXh0ID0gbmV3dGV4dFxyXG5cdH1cclxuXHJcblx0dGV4dCA9IHRleHRcclxuXHRcdC5yZXBsYWNlKC97e2ltYWdlTmFtZUtleX19L2dtLCBkYXRhLmltYWdlTmFtZUtleSlcclxuXHRcdC5yZXBsYWNlKC97e2ZpbGVOYW1lfX0vZ20sIGRhdGEuZmlsZU5hbWUpXHJcblx0XHQucmVwbGFjZSgve3tkaXJOYW1lfX0vZ20sIGRhdGEuZGlyTmFtZSlcclxuXHRcdC5yZXBsYWNlKC97e2ZpcnN0SGVhZGluZ319L2dtLCBkYXRhLmZpcnN0SGVhZGluZylcclxuXHRyZXR1cm4gdGV4dFxyXG59XHJcbiJdLAogICJtYXBwaW5ncyI6ICI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUFBO0FBQUEsMEJBQUFBLFNBQUE7QUFBQSxJQUFBQSxRQUFBO0FBQUEsTUFDSSxNQUFRO0FBQUEsTUFDUixTQUFXO0FBQUEsTUFDWCxNQUFRO0FBQUEsTUFDUixTQUFXO0FBQUEsUUFDUCxLQUFPO0FBQUEsUUFDUCxPQUFTO0FBQUEsUUFDVCxTQUFXO0FBQUEsUUFDWCxTQUFXO0FBQUEsTUFDZjtBQUFBLE1BQ0EsVUFBWSxDQUFDO0FBQUEsTUFDYixRQUFVO0FBQUEsTUFDVixTQUFXO0FBQUEsTUFDWCxpQkFBbUI7QUFBQSxRQUNmLGVBQWU7QUFBQSxRQUNmLG9DQUFvQztBQUFBLFFBQ3BDLDZCQUE2QjtBQUFBLFFBQzdCLG1CQUFtQjtB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QyxFQUFDO0FBQUEsSUFDSDtBQUVELFFBQUkseUJBQVEsV0FBVyxFQUNyQixRQUFRLDZCQUE2QixFQUNyQztBQUFBLE1BQ0E7QUFBQSxJQUNELEVBQ0M7QUFBQSxNQUFVLENBQUMsV0FDWCxPQUNFLFNBQVMsS0FBSyxPQUFPLFNBQVMsZUFBZSxFQUM3QyxTQUFTLENBQU8sVUFBVTtBQUMxQixhQUFLLE9BQU8sU0FBUyxrQkFBa0I7QUFDdkMsY0FBTSxLQUFLLE9BQU8sYUFBYTtBQUFBLE1BQ2hDLEVBQUM7QUFBQSxJQUNIO0FBRUQsUUFBSSx5QkFBUSxXQUFXLEVBQ3JCLFFBQVEsYUFBYSxFQUNyQjtBQUFBLE1BQ0E7QUFBQSxJQUNELEVBQ0M7QUFBQSxNQUFVLENBQUMsV0FDWCxPQUNFLFNBQVMsS0FBSyxPQUFPLFNBQVMsVUFBVSxFQUN4QyxTQUFTLENBQU8sVUFBVTtBQUMxQixhQUFLLE9BQU8sU0FBUyxhQUFhO0FBQ2xDLGNBQU0sS0FBSyxPQUFPLGFBQWE7QUFBQSxNQUNoQyxFQUFDO0FBQUEsSUFDSDtBQUVELFFBQUkseUJBQVEsV0FBVyxFQUNyQixRQUFRLHdCQUF3QixFQUNoQztBQUFBLE1BQ0E7QUFBQTtBQUFBO0FBQUEsSUFHRCxFQUNDO0FBQUEsTUFBVSxDQUFDLFdBQ1gsT0FDRSxTQUFTLEtBQUssT0FBTyxTQUFTLG9CQUFvQixFQUNsRCxTQUFTLENBQU8sVUFBVTtBQUMxQixhQUFLLE9BQU8sU0FBUyx1QkFBdUI7QUFDNUMsY0FBTSxLQUFLLE9BQU8sYUFBYTtBQUFBLE1BQ2hDLEVBQUM7QUFBQSxJQUNIO0FBRUQsUUFBSSx5QkFBUSxXQUFXLEVBQ3JCLFFBQVEsMkJBQTJCLEVBQ25DO0FBQUEsTUFDQTtBQUFBO0FBQUEsSUFFRCxFQUNDLFNBQVMsc0JBQXNCLEVBQy9CO0FBQUEsTUFBWSxDQUFDLFNBQ2IsS0FDRSxlQUFlLDJCQUEyQixFQUMxQyxTQUFTLEtBQUssT0FBTyxTQUFTLHVCQUF1QixFQUNyRCxTQUFTLENBQU8sVUFBVTtBQUMxQixhQUFLLE9BQU8sU0FBUywwQkFBMEI7QUFDL0MsY0FBTSxLQUFLLE9BQU8sYUFBYTtBQUFBLE1BQ2hDLEVBQUM7QUFBQSxJQUNIO0FBRUQsUUFBSSx5QkFBUSxXQUFXLEVBQ3JCLFFBQVEsdUJBQXVCLEVBQy9CO0FBQUEsTUFDQTtBQUFBO0FBQUEsSUFFRCxFQUNDO0FBQUEsTUFBVSxDQUFDLFdBQ1gsT0FDRSxTQUFTLEtBQUssT0FBTyxTQUFTLG1CQUFtQixFQUNqRCxTQUFTLENBQU8sVUFBVTtBQUMxQixhQUFLLE9BQU8sU0FBUyxzQkFBc0I7QUFDM0MsY0FBTSxLQUFLLE9BQU8sYUFBYTtBQUFBLE1BQ2hDLEVBQUM7QUFBQSxJQUNIO0FBQUEsRUFDRjtBQUNEOyIsCiAgIm5hbWVzIjogWyJtb2R1bGUiLCAiaW1wb3J0X29ic2lkaWFuIiwgInN0ZW0iXQp9Cg==
